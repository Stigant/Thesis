%\documentclass[a4paper,12pt]{book}
%\usepackage[a4paper, margin=1in]{geometry}
%\setlength{\parindent}{0cm}
%\setlength{\parskip}{1\baselineskip}
%
%\setcounter{secnumdepth}{4}
%\usepackage{amsthm}
%\usepackage{aliascnt}
%\usepackage{amsmath,amssymb,amsfonts}
%\usepackage{hyperref}
%\usepackage[shortlabels]{enumitem}
%
%\usepackage{tikz-cd}
%
%\newcommand{\basetheorem}[3]{
%	\newtheorem{#1}{#2}[#3]
%	\newtheorem*{#1*}{#2}
%	\expandafter\def\csname #1autorefname\endcsname{#2}
%}
%\newcommand{\maketheorem}[3]{
%	\newaliascnt{#1}{#3}
%	\newtheorem{#1}[#1]{#2}
%	\aliascntresetthe{#1}
%	\expandafter\def\csname #1autorefname\endcsname{#2}
%	\newtheorem{#1*}{#2}
%}
%
%%\theoremstyle{plain}
%\basetheorem{theorem}{Theorem}{section}
%\maketheorem{definition}{Definition}{theorem}
%\maketheorem{lemma}{Lemma}{theorem}
%\maketheorem{example}{Example}{theorem}
%\maketheorem{corollary}{Corollary}{theorem}
%\maketheorem{conjecture}{Conjecture}{theorem}
%\maketheorem{proposition}{Proposition}{theorem}
%\maketheorem{question}{Question}{theorem}
%\maketheorem{remark}{Remark}{theorem}
%
%\makeatletter
%\newcommand{\newreptheorem}[2]{\newtheorem*{rep@#1}{\rep@title}\newenvironment{rep#1}[1]{\def\rep@title{#2 \ref*{##1}}\begin{rep@#1}}{\end{rep@#1}}}
%\makeatother
%\makeatletter
%\@namedef{subjclassname@2020}{%
%	\textup{2020} Mathematics Subject Classification}
%\makeatother
%
%
%%\newreptheorem{theorem}{Theorem}
%
%%begin: Iacopo-defined newcommands
%\DeclareMathOperator{\Spec}{Spec}
%\DeclareMathOperator{\Proj}{Proj}
%\newcommand{\bP}{\mathbb{P}}
%\newcommand{\bR}{\mathbb{R}}
%\newcommand{\bQ}{\mathbb{Q}}
%\newcommand{\bN}{\mathbb{N}}
%\newcommand{\bZ}{\mathbb{Z}}
%\newcommand{\fB}{\mathbf{B}}
%\newcommand{\fM}{\mathbf{M}}
%\newcommand{\charac}{\textup{char }}
%\newcommand{\id}{\textup{id}}
%\newcommand{\Alb}{\textup{Alb}}
%\newcommand{\cO}{\mathcal{O}}
%\newcommand{\red}{\textup{red}}
%\newcommand{\lct}{\textup{lct}}
%\newcommand{\exc}{\textup{Ex}}
%\newcommand{\coeff}{\textup{coeff}}
%\newcommand{\cent}{\textup{centre}}
%\newcommand{\codim}{\textup{codim}}
%\newcommand{\textoverline}[1]{$\overline{\mbox{#1}}$}
%\newcommand{\rk}{\textup{rk}}
%\newcommand{\WDiv}{\textup{WDiv}}
%%end: Iacopo-defined newcommands
%
%
%\newcommand{\A}{\mathcal{A}}
%\newcommand{\B}{\mathcal{B}}
%\newcommand{\C}{\mathcal{C}}
%\newcommand{\E}{\mathcal{E}}
%\newcommand{\F}{\mathcal{F}}
%\newcommand{\PP}{\mathcal{P}}
%\newcommand{\HH}{\mathcal{H}}
%\newcommand{\SB}{\mathbf{SB}}
%\newcommand{\BB}{\mathbf{B}}
%\newcommand{\BS}{\mathbf{B}_{+}}
%\newcommand{\disc}{\text{Discrepancy}}
%
%
%\newcommand{\ta}[1]{\mathcal{A}^{\leq #1}}
%\newcommand{\at}[1]{\mathcal{A}^{\geq #1}}
%\newcommand{\tb}[1]{\mathcal{B}^{\leq #1}}
%\newcommand{\bt}[1]{\mathcal{B}^{\geq #1}}
%\newcommand{\tc}[1]{\mathcal{C}^{\leq #1}}
%\newcommand{\ct}[1]{\mathcal{C}^{\geq #1}}
%\newcommand{\nklt}{\textup{Nklt}}
%\newcommand{\Ht}[1]{H^{i}_{t}}
%\newcommand{\orth}{^{\perp}}
%\newcommand{\Hom}{\textup{Hom}}
%\newcommand{\shom}{\mathcal{H}\textup{om}}
%\newcommand{\Fe}{F^{e}_{*}}
%\newcommand{\Fn}[1]{F^{#1}_{*}}
%\newcommand{\trip}{(R,\Delta, \alpha_{\bullet})}
%\newcommand{\ai}{\alpha_{\bullet}}
%\newcommand{\im}{\textup{Im}}
%\newcommand{\ox}[1][X]{\mathcal{O}_{#1}}
%\newcommand{\me}{M^{e}_{\Delta,a^{t}}}
%\newcommand{\psim}{\sim_{\mathbb{Z}_{(p)}}}
%\newcommand{\zp}{\mathbb{Z}_{(p)}}
%\newcommand{\Xde}[1]{\mathcal{X}_{\delta,\epsilon,#1}}
%\newcommand{\Pde}[1]{\mathcal{P}_{\delta,\epsilon,#1}}
%\newcommand{\coker}{\text{coker }}
%\newcommand\myworries[1]{\textcolor{red}{#1}}
%
%\begin{document}
\chapter{Preliminaries}
\section{Singularity Theory} \label{Sings}

We begin by collecting relevant notions of singularities for the minimal model program in mixed and positive characteristic. These include classic notions coming from the characteristic $0$ setting, as well as algebraic singularity conditions developed in the positive characteristic setting.

\subsection{Singularities of pairs}
Here $\mathbb{K}$ will be taken to mean either $\mathbb{R}$ or $\mathbb{Q}$. If no field is specified, it is taken to be $\mathbb{R}$, i.e. a log pair is always a log pair with $\mathbb{R}$ boundary.

\begin{definition}\label{log-pair}
	
	A sub-log pair $(X,\Delta)$  with $\mathbb{K}$ boundary is an excellent, Noetherian, integral, normal scheme $X$ admitting a dualising complex together with an $\mathbb{K}$-divisor $\Delta$ such that $(K_{X}+\Delta)$ is $\mathbb{K}$-Cartier. If $\Delta$ is effective, we say $(X,\Delta)$ is a log pair.
	
	\end{definition}

In practice we study these almost exclusively in the following context.

\begin{definition}\label{setup}
	A sub $R$-pair $(X,\Delta)/ T$ with $\mathbb{K}$-boundary will be the following data:
	\begin{itemize}
		\item A sub log pair $(X,\Delta)$ with $\mathbb{K}$ boundary;
		\item An excellent, normal ring $R$ of finite dimension which admits a dualising complex and whose residue fields have characteristic at least $5$;
		\item A quasi-projective $R$-scheme $T$; and
		\item A projective contraction $f \colon X \to T$.
	\end{itemize}
	
	The dimension of such a pair is the dimension of $X$. Equally the pair is said to $\mathbb{Q}$-factorial if $X$ is.
	
	If $\Delta\geq 0$ we call it an $R$-pair with $\mathbb{K}$ boundary.
\end{definition}

Note that $f \colon X \to T$ is a contraction ensures that $X \to T$ is surjective and $T$ is integral and normal. We include this assumption for notational simplicity. All results extend to the case $f$ is not a contraction by taking a Stein factorisation, though for some results this may require assumptions on the dimension of $T$ be replaced with corresponding assumptions on the dimension of $f(X)$. 


%\begin{remark}
%	
%	We require the relative data of $R$ and $T$ so that the notion of an $R$-pair captures the the kind of MMPs we wish to run. Many notions of singularity do not depend on this data however, instead many of them are local on $X$. For such notions we may work affine locally on $X$ and let $X \to T \to R$ be the identity map to recover these as intrinsic notions of singularity.
%\end{remark}

In practice we will often have $T=R$. In this case we may omit $T$ from the notation and say only that $(X,\Delta)$ is an $R$-pair. If further $R=\kappa$ is a field, we often say one that $(X,\Delta)$ is a pair over a field or just that $(X,\Delta)$ is a pair, depending on context. Finally if $\Delta=0$ we just say that $X/T$ is an $R$-pair.

We will often ask that $X \to T$ has positive dimensional image, or equally that $T$ is positive dimensional. Partly, this is because many results for threefolds are not known in greater generality than this, for example much is unknown when $X$ is a variety over an imperfect field. Also many of the arguments will rely on lifting results from the general fibre, which only works for positive dimensional bases.

%In cases where $R$ is clear from context we often describe an $R$-pair with $\mathbb{K}$-boundary as a $\mathbb{K}$-pair. While we will sometimes work with schemes over a field of characteristic $0$, it will never be relevant whether that field is $\mathbb{Q}$ or $\mathbb{R}$. Therefore a $\mathbb{K}$-pair will only ever mean a pair with coefficients in $\mathbb{K}$ and never pair whose underlying scheme is of finite type over the field $\mathbb{K}$. 

Since $K_{X}+\Delta$ is $\mathbb{R}$-Cartier, we may pull it back along any morphism $\pi\colon  Y \to X$. If $\pi$ is birational then there is a unique choice of $\Delta_{Y}=\sum -a(Y,E,X,\Delta)E$ which agrees with $\Delta$ away from the exceptional locus of $\pi$ such that $\pi^{*}(K_{X}+\Delta)\sim_{\mathbb{R}}=K_{Y}+\Delta_{Y}$. In a slight abuse of notation we write $f^{*}(K_{X}+\Delta)=(K_{Y}+ \Delta_{Y})$.

Suppose that there are normal, integral schemes $Y_{i}$ with $f_{i}:Y_{i} \to X$ birational and there is a some normal, integral scheme $Z$ with $g_{i}:Z\to Y_{i}$. If $E_{i}$ are divisors on $Y_{i}$ with a common strict transform $E$ on $Z$ then $a(Z,E,X,\Delta)=a(Z,E,Y_{i},\Delta_{Y_{i}})=a(Y_{i},E_{i},X,\Delta)$ since we have $g_{i}^{*}f_{i}^{*}r(K_{X}+\Delta)=g_{i}^{*}r(K_{Y_{i}}+\Delta_{Y_{i}})$.

We may view, then, the values of $a(Y,E,X,\Delta)$ as being independent of the model $Y$ and write $a(E,X,\Delta)$ instead. 

For every prime divisor $E$ on a birational model, $Y$, of $X$ we have an associated DVR $\mathcal{O}_{Y,E}$, the stalk at the generic point of $E$ which gives a valuation, $\nu_{E}$ on the function field $K(X)$. If $f\colon Y \to X$ is a birational morphism and $D$ a prime divisor on $Y$ together with a choice of generator inside $K(X)$ then pulling back $D$ and looking at its coefficient at $E$ is equivalent to asking for the valuation under $\nu_{E}$. 

In general, the converse is false. Not every valuation can be applied to $K_{X}$ in this fashion.

For example suppose $X$ is a proper normal variety over a field which is not $\mathbb{Q}$-Gorenstein. Let $U$ be the smooth locus and $P$ a point at which $X$ is not $\mathbb{Q}$-Gorenstein. We may blowup $X$ at $P$ to give $Y \to X$ with $E$ lying over $P$. Then $U$ is smooth and birational to $Y$, but we cannot take the valuation of $K_{U}$ with respect to $E$ since no multiple of $K_{U}$ is Cartier on $X$. If we wish to think of the $a(X,\Delta,E)$ as coming from valuations we must, therefore, consider only those with non-empty center on $X$. 

\begin{definition}
	Let $A$ be an integral domain with $\text{Frac}(A)=K$ and $R$ a DVR in $K$ with maximal ideal $m_{R}$. Then the center of $R$ in $A$ is $m_{R}\cap A$. We extend the definition to normal, integral schemes in the natural fashion.
\end{definition}

If $X$ is of finite type over a locally Noetherian scheme $T$ then $X$ is proper over $T$ if and only if every $T$-valuation has non-empty centre on $X$, by the valuative criterion of properness \cite[Tag 0208]{stacks-project}. 

Equally for a prime divisor $E$ on a birational model $Y$ of $X$, we can think of it as having non-empty centre on $X$ if there is a dominating model $Z \to X,Y$ such that the generic point of $E$ is contained in the image of $Z$ on $Y$. This is the same as asking for the valuation it induces to have non-empty centre on $X$. In fact we can realise the centre of the valuation as the closure of the strict transform of $E$.

For simplicity, we will always think of a divisor $E$ with non-empty centre on $X$ as lying on a model $Y$ which dominates $X$. Since the valuation does not depend on the birational model, we can always choose a higher model to ensure this is a valid assumption. 

\begin{definition}
	
	Let $\pi\colon Y \to X$ be a proper birational morphism of integral, normal schemes. A divisor $E$ on $Y$ is said to be exceptional if $\pi$ is not an isomorphism at the generic point of $E$, or equally if the centre of $E$ is not a divisor on $X$.
	
	Given a sub-pair $(X,\Delta)$ we define the discrepancy $$\text{Disc}(X,\Delta):=\inf \{a(E,X,\Delta) \text{ such that } E \text{ is exceptional and has non-empty center on } X\}$$
	and the total discrepancy 
	$$\text{TDisc}(X,\Delta):=\inf \{a(E,X,\Delta) \text { such that } E \text{ has non-empty center on } X\}$$
\end{definition}

We then use this define a suite of singularities.

\begin{definition}
	Let $(X,\Delta)$ be a (sub)-log pair then we say that $(X,\Delta)$ is
	\begin{itemize}
	\item 	(sub) terminal if $\text{Disc}(X,\Delta) > 0$
	\item	(sub) canonical if $\text{Disc}(X,\Delta)\geq 0$
	\item 	(sub) plt if $\text{Disc}(X,\Delta)\geq -1$
	\item	(sub) $\epsilon$-klt if $\text{TDisc}(X,\Delta) > \epsilon-1$
	\item	(sub) $\epsilon$-lc if $\text{TDisc}(X,\Delta) \geq \epsilon -1$
	\end{itemize}
\end{definition}

\begin{remark}
	
	Klt is short for Kawamata log terminal and lc is short for log canonical.
	\end{remark}

For $\epsilon=0$ we say klt, lc respectively. We also say $X$ has singularities of type $\mathcal{P}$ to mean $(X,0)$ has such. An equivalent formulation of lc is that $\text{Disc}(X,\Delta) \geq -1$ as this condition ensures that $\Delta$ has coefficients bounded above by $1$.

\begin{lemma}
	
	Let $(X,\Delta)$ be a (sub)-log pair with $\text{Disc}(X,\Delta) \geq -1$, then $X$ is lc.
	
	\end{lemma}

\begin{proof}
	Suppose for contradiction $X$ has $\text{Disc}(X,\Delta) \geq -1$ but not $\text{TDisc}(X,\Delta) \geq -1$. Let $D$ be in the support of $\Delta$ with $\text{Coeff}_{D}(\Delta) > 1$. Since $X$ is normal we may localise at $Q$ a point of codimension $2$ inside the smooth locus of $X$ and $D$ which meets no other component of $\Delta$. This reduces us to the case that $X$ is smooth of dimension $2$ and the support of $D$ is a smooth curve, $C$. Now by assumption we have that $D=(1+\epsilon)C$ for $\epsilon > 0$. If we blow up the closed point, we get an exceptional divisor $E$ with $a(E,X,\Delta)=-\epsilon$. Blowing up the intersection of $E$ and the strict transform of $\Delta$ gives $E_{2}$ with $a(E_{2},X,\Delta)=-2\epsilon$. Continuing in this fashion we can find $E_{n}$ with $a(E_{n},X,\Delta)=-n\epsilon< -1$ for some suitably large $n$.

Since $\text{Disc}(X,\Delta) \geq -1$ no such $E_{n}$ can exist, so the result holds by contradiction.
\end{proof}

Note that if $(X,B)$ and $(X,\Delta)$ are log pairs with $\Delta \geq B$ then clearly $a(E,X,\Delta) \leq a(E,X,B)$. So $(X,B)$ cannot have singularities which are worse, in the above sense, than $(X,\Delta)$. Moreover if $(X,\Delta)$ is sub $\epsilon$-lc and $(X,B)$ is sub $\epsilon$-klt then so is any sub-log pair $(X,D)$ with $D \leq \delta B+(1-\delta)\Delta$ for any $1>\delta >0$.

When we have resolution of singularities there is another, more practical version of these definitions.

\begin{definition}
	
	We say $(X,\Delta)$ is log regular if $X$ is a regular scheme and $\Delta=\sum d_{i}D_{i}$ is a divisor with normal crossing support
	
	If $(X,\Delta)$ is a sub-log pair and $\pi\colon Y \to X$ is projective, birational morphism with exceptional locus $E$ such that $(Y,\pi^{-1}_{*}\Delta+E)$ is log regular then $\pi\colon Y\to X$ is a log resolution of $(X,\Delta)$. In this case, we sometimes say $\pi\colon Y \to (X,\Delta)$ is a log resolution.
	
\end{definition}

When $R$ is a closed field we often say log smooth instead of log regular.

\begin{remark}
	
	In principle it is enough for a log resolution to be proper for the purposes of these valuative notions of singularity. In practice we will often want projective log resolutions for other reasons and we do not separate the notions.
	
	\end{remark}

\begin{lemma}
	Suppose that $(X,\Delta)$ is log regular. Let $E$ be a prime divisor with center $V\neq E$ on $X$, write $P$ for the generic point of $V$. Let $\Delta= \sum d_{i}D_{i}$.
	Then \begin{enumerate}
		\item $a(E,X,D)\geq codim(P,X) -1-\sum_{i: P\in D_{i}}d_{j}$
		\item $\text{TDisc}(X,\Delta)=\min\{0,-d_{i}\}$
		\item $\text{Disc}(X,\Delta) =\min\{1,1-d_{i},1-d_{i}-d_{j}\text{: } D_{i} \cap D_{j}\neq \emptyset\}$

	\end{enumerate}
\end{lemma}
\begin{proof}
	Let $Y \to X$ be a birational morphism such that $E$ is a divisor on $Y$, let $Q$ be its generic point. Localise at $P$ in $X$ so we may suppose that $P$ is closed and given by the vanishing of $x_{1},...x_{n}$ where $n=\text{codim}(P,X)$. Similarly we may suppose $E$ is given as the vanishing of a local coordinate $y_{1}$ on $Y$. Since $(X,\Delta)$ is log regular we may, after reordering, suppose $D_{1},..D_{k}$ contain $P$ and each is given as the vanishing of a local coordinate $x_{i}$. Further can write $f^{*}x_{i}=y_{1}^{a_{i}}u_{i}$ where $u_{i}$ does not vanish at $Q$ and $a_{i}\in \mathbb{Z}_{>0}$.
	
	We then have $$f^{*}dx_{i}=a_{i}y_{i}^{a_{i}-1}u_{i}dy_{1} + y_{1}^{a_{i}}du_{i}$$ by the chain rule where $du_{i}=w_{i}$ are regular at $Q$.
	
	Putting $c_{i}=d_{i}$ for $i \leq k$ and $c_{i}=0$ otherwise gives
	$$f^{*}\frac{dx_{i}}{x_{i}^{d_{i}}}=a_{i}y_{1}^{(1-c_{i})a_{i}-1}u_{i}^{1-c_{i}}dy_{1} +y_{1}^{(1-c_{i})a_{i}}w_{i}.$$
	
	However then we see that the only possible poles of 
	$$f^{*}\frac{dx_{1}\wedge...\wedge dx_{n}}{x_{1}^{c_{1}}...x_{n}c^{n}}$$
	at $Q$ come from 
	
	$$y_{1}^{A_{i}}dy_{1}\wedge w_{1}\wedge ... \wedge w_{i-1} \wedge w_{i+1} \wedge... \wedge w_{n}$$
	with $$A_{i}=-1+ \sum_{1}^{n} (1-c_{j})a_{j} \geq -1+\sum _{1}^{n}a_{j} -\sum_{1}^{k} d_{j}a_{j} \geq n -1 - \sum_{1}^{k} d_{j},$$ giving $(1)$.
	
	For any $E$ with center $V$ we have $a(E,x,D) \geq \text{codim}(V,X) -1 - \sum_{V \subseteq D_{i}} d_{i}$ and since $d_{i} \leq 1$ for every $i$ the smallest value occurs when $V=E$ has codimension $1$ and we obtain $\text{TDisc}(X,\Delta)=\min\{0,-d_{i}\}$. Similarly if $E$ is required to be exceptional we must have the smallest values when $V$ has dimension $2$ so that $\text{Disc}(X,D)\geq \min\{1,1-d_{i},1-d_{i}-d_{j} \text{ such that }D_{i}\cap D_{j} \neq \emptyset\}$.
	
	 Suppose however we blow up $V\subseteq D_{i}$ of codimension $2$ and label the exceptional divisor $E$. It is an easy calculation that $a(E,X,D)=1-d_{i}$ if $V\not\subseteq D_{j}$ for all $j$ else $a(E,X,D)=1-d_{i}-d_{j}$ where $V \subseteq D_{j}$ giving $2$. Similarly by blowing up $V$ of codimension $2$ not contained in any $D_{i}$ we see that there is some $E$ with $a(X,E,D)=1$ so $(3)$ holds.
	 
\end{proof}


% Indeed as $X$ is normal, we may restrict to an open set and assume that $\Delta$ is a prime divisor with $(X,\Delta)$ log smooth. Now blowing up along $V$ inside $\Delta$ of codimension $2$, we may instead assume that 

%\begin{corollary}
%	Let $(X,\Delta)$ be a (sub)-log pair and $\pi\colon Y\to X$ a log resolution of $(X,\Delta)$. Let $$t=\min\{a(E,X,\Delta) \text{ such that } E \text{ is a divisor on } Y\}$$ and $$d=\min\{a(E,X,\Delta) \text{ such that } E \text{ is an exceptional divisor of } \pi\colon Y\to X\}.$$
%	Then $(X,\Delta)$ is
%		\begin{itemize}
%		\item 	(sub) plt if $d > -1$
%		\item	(sub) $\epsilon-klt$ if $t > \epsilon-1$
%		\item	(sub) $\epsilon-lc$ if $t\geq \epsilon -1$
%	\end{itemize}
%\end{corollary}



\begin{corollary}
	Let $(X,\Delta)$ be a (sub)-log pair and $\pi\colon Y\to X$ a log resolution of $(X,\Delta)$. Let $-d_{i}$ be the coefficients of $\Delta_{Y}$ and $d=\min d_{i}.$
	Then $(X,\Delta)$ is
	\begin{itemize}
		\item 	(sub) terminal iff $d > -1$ and $d_{i}+d_{j} > -1$ if $D_{i} \cap D_{j} \neq \emptyset$.
		\item	(sub) canonical iff $d \geq -1$ and $d_{i}+d_{j} \geq - 1$ if $D_{i} \cap D_{j} \neq \emptyset$. 
		\item 	(sub) plt iff $d \geq -1$ and $d_{i}+d_{j} > -2$ if $D_{i} \cap D_{j} \neq \emptyset$.
		\item	(sub) $\epsilon-klt$ iff $d > \epsilon-1$ .
		\item	(sub) $\epsilon-lc$ iff $d \leq \epsilon-1$.
	\end{itemize}
\end{corollary}

In particular we see that klt and lc may be checked in terms of the total discrepancy coming from a single log resolution. Terminal and canonical may also be checked in terms of discrepancy of a single resolution if $\Delta=0$. If $X$ is $\mathbb{Q}$-factorial then $(X,\Delta)$ is plt only when $\lfloor \Delta \rfloor$ is disjoint by \cite[Lemma 2.28]{bhatt2020}. In this setting we may say, with notation as above, that $(X,\Delta)$ is plt if and only if $\lfloor \Delta \rfloor$ is disjoint, $\lfloor \Delta_{Y} \rfloor=\pi_{*}^{-1}\lfloor \Delta \rfloor$ and $d \geq -1$.

These calculations also give rise to an additional notion of singularity.

\begin{definition}
	An $R$ pair $(X,\Delta)$ is called dlt if it lc and there is a closed subscheme $Z \subseteq Z$ such that:
	
	\begin{itemize}
		\item $X\setminus Z$ is regular, 
		\item $\Delta|_{X\setminus Z}$ is simple normal crossing
		\item If $E$ is an exceptional divisor with centre in $Z$ then $a(E,X,\Delta) > -1$.
	\end{itemize}
	
	
	 
\end{definition}

Roughly speaking this says a dlt pair is an lc pair with is klt away from the locus where it is log smooth.

Note that if $(X,\Delta)$ is plt then it is also dlt. 

\begin{remark}
	
	We can also characterise dlt with reference to a log resolution as follows. A pair $(X,\Delta)$ is dlt if there is a log resolution $\pi\colon Y \to X$ of $(X,\Delta)$ with $K_{Y}+\Delta_{Y}=\pi^{*}(K_{X}+\Delta)$ such that $\text{Coeff}_{E}(\Delta_{Y}) < 1$ for every $E$ exceptional. The converse implication holds if sufficiently strong resolution results are known. 
	
	This definition is not independent of the resolution. Consider for example $X$ a smooth surface with $\Delta=C_{1}+C_{2}$ with connected log smooth support. This is trivially dlt, however if we blow up a point $P$ in $C_{1}\cap C_{2}$ then the pullback of $K_{X}+\Delta$ has coefficient $1$ at the exceptional divisor.

\end{remark}

Allowing sub-pairs, being klt, lc etc pulls back naturally along birational morphisms. The following lemma allows us to push forward along them as well.

\begin{lemma}[Negativity Lemma]\cite[Lemma 2.14]{bhatt2020}\label{negatvity}
	Let $f\colon X \to Y$ be a projective birational morphism of normal, excellent, integral schemes. Let $D$ be an $\mathbb{R}$ Cartier divisor on $X$ with $-D$ nef over $Y$. Then $D$ is effective if and only if $f_{*}D$ is.
\end{lemma}

%\begin{lemma}
%	Suppose that $(X,\Delta)$ is a pair equipped with a morphism $f\colon X \to Y$. Suppose that $(Y,f_{*}\Delta)$ is a pair, that is $K_{Y}+f_{*}\Delta$ is $\mathbb{R}$-Cartier, and that $-(K_{X}+\Delta)$ is nef over $Y$. Then given $Z\to X$ a birational morphism of normal varieties, and $E$ a divisor on $Z$, we have $a(E,X,\Delta) \leq a(E,Y,f_{*}\Delta)$
%\end{lemma}
%\begin{proof}
%	Consider 
%	\[D=f^{*}(K_{Y}+f_{*}\Delta)-(K_{X}+\Delta)\]
%	which is nef over $Y$ by assumption. Then $-f_{*}D=0$, and in particular is effective, giving that $-D$ is effective by the negativity lemma. Hence we have $(K_{X}+\Delta) \geq  f^{*}(K_{Y}+f_{*}\Delta)=(K_{X}+\Delta')$, and so $a(E,Y,f_{*}\Delta)=a(E,X,\Delta') \geq a(E,X,\Delta)$ as required. 
%\end{proof}
%
%More generally we have the following.

\begin{lemma}\label{l:increase-discr}
	Suppose $(X,\Delta),(X',\Delta')$ are log pairs equipped with projective birational morphisms $f\colon X \to Y$ and $f':X'\to Y$ with $f_{*}\Delta=f'_{*}\Delta'$.
	
	Suppose further that $-(K_{X}+\Delta)$ is $f$ nef and $(K_{X'}+\Delta')$ is $f'$ nef. Then $a(E,X,\Delta) \leq a(E,X',\Delta')$ for any $E$ with non-trivial center on $Y$.
	
	If in fact $-(K_X+\Delta)$ is $f$-ample and $f$ is not an isomorphism above the generic point of $\cent_X(E)$, then
	$$ a(E, X, \Delta ) < a(E, X', \Delta').$$
\end{lemma}
\begin{proof}
	Let $Z$ be a normal, integral scheme with projective, birational morphisms $g\colon Z \to X$ and $g':Z \to X'$, write $h=f \circ g=f' \circ g'$. Let $D= g^{*}(K_{X}+\Delta)-g'^{*}(K_{X'}+\Delta')$ which is exceptional by construction. Further since nefness is preserved under pulllback, $-D$ is nef over $Y$ and hence we may apply the negativity lemma to see that $D$ is effective. Thus $g^{*}(K_{X}+\Delta) \leq g'^{*}(K_{X'}+\Delta')$. In particular if $E$ is any divisor on $Z$, then $a(E,X,\Delta) > a(E,X,\Delta')$.
	
	Suppose now $E$ is a valuation with non-trivial center on $Y$. There is some $Z \to Y$ with $E$ a divisor on $Z$. We may then resolve the indeterminacy of $Z \to X$ and $Z \to X'$ and assume wlog that $Z$ lies over $X,X'$ also and the first part of result follows.
	
	In the latter case, we see that $E$ is covered by curves $C$ with $D.C <0$. Hence we must have that $E$ is in the support of $D$ and $a(E,X,\Delta) > a(E,X,\Delta')$.
\end{proof}

This is exactly the result that shows these notions of singularity are preserved under a $(K_{X}+\Delta)$ MMP.


%\begin{definition}
%	A (sub) $\epsilon$-lc pair $(X,\Delta)/T$ where $K_{X}+\Delta \equiv_{T} 0$ is said to be (Sub) $\epsilon$-log Calabi-Yau, or just (sub) $\epsilon$-LCY. 
%\end{definition}
%Again for $\epsilon=0$ we just say LCY.
%\begin{corollary}
%	Suppose that $(X,\Delta)$ is $\epsilon$-LCY and $f\colon X\dashrightarrow X'$ is either a flip or a divisorial contraction then $(X',f_{*}\Delta)$ is $\epsilon$-klt.
%\end{corollary}
%\begin{proof}
%	Both $(K_{X}+\Delta)$ and $(K_{X'}+\Delta')$ are numerically trivial so it suffices to show that $(K_{X'}+\Delta')$ is $\mathbb{R}$ Cartier. 
%	
%	Note then that if $g\colon X \to Y$ is the contraction of an extremal ray and $D\equiv_{g} 0$ is Cartier, there is some $L$ Cartier on $Y$ with $g^{*}L=D$. If $f$ is a divisorial contraction then $r(K_{X}+\Delta)=f^{*}L$ say and so $r(K_{X'}+\Delta')=L$ by the projection formula. Else $f$ is a flip and there is $g\colon X \to Y$ a flipping contraction together with $g':X' \to Y$ such that $f=g'^{-1}\circ g$. Hence writing $r(K_{X}+\Delta)=g^{*}L$ again gives $r(K_{X'}+\Delta')=g'^{*}L$.
%\end{proof}

\subsection{Frobenius singularities}

This section will focus on Frobenius singularities in positive characteristic. These will only be needed for schemes over a field, though one can make sense of these definitions in a more general context. We will often work with varieties over a field $\kappa$, which here will mean just mean integral, quasi-projective $\kappa$-schemes.

\subsubsection{Frobenius singularities of pairs}

\begin{definition}
Given a $\kappa$ algebra $R$ over positive characteristic we denote the Frobenius morphism by $F\colon R\to R$ sending $x \to x^{p}$. Any $R$ module $M$ then has an induced module structure, denoted $F_{*}M$ where $R$ acts as $r.m=F(r)m=r^{p}m$. Finally $R$ is said to be $F$-finite if $F_{*}R$ is a finite $R$ module. This is a particularly important notion in the case that $R=\kappa$.

These definitions naturally extend to schemes over $\kappa$. 
\end{definition}

Note that all perfect fields are $F$-finite. Moreover any finitely generated algebra over an $F$-finite field is itself $F$-finite. In particular varieties over an $F$-finite field are $F$-finite.

In this context we can view the Frobenius morphism as a map of $R$ modules $F\colon R \to F_{*}R$. We will also write $F^{e}:R \to F_{*}^{e}R$ for the $e^{th}$ iterated Frobenius.

We have the following well known result due to Kunz.

\begin{theorem}\cite[Tag 0EC0]{stacks-project}\cite{kunz1969characterizations}
	Let $R$ be a reduced Noetherian local ring of characteristic $p> 0$, then $R$ is regular if and only if $F_{*}R$ is a flat $R$ module.
\end{theorem}

It is natural then to try and understand the singularities of a scheme via flatness conditions on $F_{*}R$. In the first instance we have the following definitions.

\begin{definition}
	Let $X$ be a normal variety over an $F$-finite field.
	We say $X$ is:
	\begin{itemize}
		\item $F$-pure if the Frobenius morphism $\ox \to F_{*}\ox$ is pure, or equivalently locally split.
		\item (Globally) $F$-split if the Frobenius morphism $\ox \to F_{*}\ox$ is split.
	\end{itemize} 
\end{definition}

Here for a morphism $f\colon R \to S$ to be pure means the induced map $M \to M \times S$ is injective for every $R$ module $M$. When $S$ is a finite $R$ module, $f$ is pure if and only if it is split. That is there is a morphism $g\colon S \to R$ of $R$ modules with $g \circ f =id$.

\begin{remark}

	This purity condition is closed related to both flatness and effective descent. Roughly speaking every flat morphism is an effective descent morphism, but in general an effective descent morphism need only be pure. In fact purity turns out to be a sufficient condition also \cite[Tag 08WE]{stacks-project}.
	
	In particular regular varieties are $F$-pure.
	
	\end{remark}

While these are useful definitions in their own right, for the purposes of the MMP we would like ones which can be more naturally applied to pairs $(X,\Delta)$.

Take $X$ a normal variety over an $F$-finite field. To mirror the notion of a boundary we introduce pairs $(\mathcal{L}, \phi)$ where $\mathcal{L}$ is a line bundle and $\phi: \Fe \mathcal{L} \to \ox$. By applying duality on the regular locus, which contains all the codimension $1$ points, we observe that $\Hom_{\ox}(\Fe \mathcal{L},\ox)=H^{0}(X,\mathcal{L}^{-1}((1-p^{e})K_{X}))$. Therefore such a pair corresponds to a divisor $\Delta_{\phi} \geq 0$ with $(1-p^{e})(K_{X}+\Delta_{\phi}) \sim \mathcal{L}$. Reversing this procedure is slightly more involved. If ${(1-p^{e})(K_{X}+\Delta) \sim \mathcal{L}}$ (we sometimes write this $K_{X}+\Delta \sim_{\zp} \mathcal{L}^{-1}$) we may obtain $\phi_{\Delta}:\Fe \mathcal{L} \to \ox$, however we could also write say $(1-p^{2e})(K_{X}+\Delta) \sim \mathcal{L'}$ where $\mathcal{L'} \not\sim \mathcal{L}$. We introduce, therefore, the following notion of equivalence.

First, we say that two such pairs, $(\mathcal{L}, \phi)$ and $(\mathcal{L}', \phi')$ are said to be equivalent if:

\begin{itemize}
	\item There is an isomorphism $\psi: \mathcal{L} \to \mathcal{L'}$ such that following diagram commutes.
	\[\begin{tikzcd}
	\Fe \mathcal{L} \arrow[rd, "\phi"] \arrow[rr, "\Fe \psi"] &     & \Fe \mathcal{L}' \arrow[ld, "\phi'"] \\
	& \ox &                                     
	\end{tikzcd}\]
	\item Or $\mathcal{L}=\mathcal{L}^{p^{e'}+1}$ and $\phi'\colon \Fe[e+e']\mathcal{L}^{p^{e'}+1}\to \ox$ is the precisely the map given by
		$$\Fe[e+e'](\mathcal{L}\otimes \mathcal{L}^{p^{e'}}) \xrightarrow{\Fe\phi} \Fe \mathcal{L} \xrightarrow{\phi} \ox.$$
		
% $$F_{*}^{m}\mathcal{L}^{k} \otimes F_{*}^{n} \mathcal{L}^{r}\cong F_{*}^{m}(\mathcal{L}^{rp^{m-n}+k}) \to F^{m}_{*}\mathcal{L}^{k}\to \ox$$ for $m>n$.
\end{itemize}

We then expand the notion of equivalence to allow any finite combination of the above equivalences, more precisely we take the transitive closure of our initial relation.

The need for first part of this is clear. The second comes from the following lemma

\begin{lemma}\label{twist}
	Suppose that $(\mathcal{L},\phi)$ and $(\mathcal{L}',\phi')$ are pairs as above. Then we have the following map
	\[\psi= \phi' \circ_{F} \phi: F^{e+e'}_{*}(\mathcal{L}\otimes (\mathcal{L}')^{p^{e}})\cong F_{*}^{e'}(\Fe \mathcal{L} \otimes \mathcal{L}')\to F^{e'}_{*}\mathcal{L}'\to \ox \]
	and the associated divisor is $\Delta_{\psi}= \frac{p^{e}-1}{p^{e+e'}-1}\Delta_{\phi} + \frac{p^{e}(p^{e'}-1)}{p^{e+e'}-1}\Delta_{\phi'}$.

\end{lemma}

\begin{proof}
	
	The statement is local, so we may suppose that $\mathcal{L}=\mathcal{L}'=\mathcal{O}_{X}$ and $X= \text{Spec}R$. Fix $\Phi: F_{*}R \to R$ the generating map of $\Hom_{R}(F_{*}R,R)$ as an $F_{*}R$ module. Hence we have $\phi=x.\Phi^{e}$ and $\phi'=x'.(\Phi)^{e'}$. Hence we clearly have $$\psi(r)=\phi'\circ F_{*}^{e'}(\phi)(r)= \Phi^{e'}\circ (x'(F_{*}^{e'}(x.\Phi^{e}))(r)=\Phi^{e+e'}(x(x')^{p^{e}})r).$$
	
	
	Hence we see that the divisor is 
	\begin{align*}
	\Delta_{\psi} &= \frac{1}{p^{e+e'}-1}(\text{div}(x) + p^{e}\text{div}(x')) \\
	&=\frac{p^{e}-1}{p^{e+e'}-1}\Delta_{\phi} + \frac{p^{e}(p^{e'}-1)}{p^{e+e'}-1}\Delta_{\phi'}.
	\end{align*}
	
	Since we must have $\Delta_{(x.\Phi^{k})}= \frac{1}{p^{k}-1} \text{div}(x)$ under the identification $\Hom_{R}(\Fe R,R) \cong \Fe R$.

	
\end{proof}

We write $\phi^{n}$ for $\phi^{n-1}\circ_{F} \phi$. Note that by the above calculation, $\Delta_{\phi^{n}}=\Delta_{\phi}$, which is why we require the second part of the equivalence relation.

\begin{remark}\label{R-twist}

We might ask if this construction still makes sense for $e=0$. Obviously we cannot divide by $p^{e}-1$ but if we run through the correspondence, we are simply identifying $\Hom(\mathcal{L},\ox)$ with $\Hom(\ox,\mathcal{L}^{-1})$. So a morphism $\phi: \mathcal{L} \to \ox$ induces a divisor $D_{\phi}$ with $\ox(D_{\phi})\simeq \mathcal{L}^{-1}$. Then we get the formula
\[\Delta_{\phi' \circ_{F} \phi}= \frac{1}{p^{e'}-1}D_{\phi} + \Delta_{\phi'}\]

Similarly when $e'=0$ we get $\Delta_{\phi' \circ_{F} \phi}=\Delta_{\phi' \circ \phi}=\Delta_{\phi} + \frac{p^{e}}{p^{e}-1}D_{\phi'}$ and if $e=e'=0$ we recover the usual composition formula $D_{\phi' \circ \phi}=D_{\phi} + D_{\phi'}$.

Suppose $\phi: \mathcal{L}\mathcal{L'}^{-1} \to \ox$ then $\phi$ corresponds to a divisor $D\sim \mathcal{L'}\mathcal{L}^{-1}$ in the usual sense. The result is than that $\psi=\phi \circ_{F} \phi': F_{*}^{e'}(\mathcal{L}\mathcal{L'}^{-1} \otimes \mathcal{L'})=F_{*}^{e'}(\mathcal{L}) \to F_{*}^{e'}(\mathcal{L'})\to\ox$ has $\Delta_{\psi}=\frac{1}{p^{e}-1}D+\Delta_{\phi'}$ from above. Equally of course we may view $\phi$ as a morphism $\mathcal{L} \to \mathcal{L'}$. 

\end{remark}

Note that \autoref{twist} and \autoref{R-twist} can be applied in the opposite direction. Suppose that $\phi,\psi$ have $\Delta_{\phi} \geq \delta_{\psi}$. Let $E=\Delta_{\phi}-\Delta_{\psi}$. Then we get an induced map $\Fe i_{(p^{e}-1)E} \colon \Fe \mathcal{L}_{\phi} \to \Fe \mathcal{L}_{\psi}$. Now $\psi \circ_{F} i_{(p^{e}-1)E}$ has induced boundary $\frac{1}{p^{e}-1}(p^{e}-1)E+\Delta_{\psi}=\Delta_{\phi}$. Hence in fact $\phi=\psi \circ_{F} i_{(p^{e}-1)E}$.

In particular then, every $\phi$ is of the form $\Fe \mathcal{L} \to \Fe \omega_{X}^{\otimes(1-p^{e})} \to \ox$ where $\Fe \mathcal{L} \to \Fe \omega_{X}^{\otimes(1-p^{e})}$ is the pushforward of the inclusion $\ox((1-p^{e})(K_{X}+\Delta_{\phi})) \to \ox((1-p^{e})(K_{X}))$ induced by $(1-p^{e})\Delta_{\phi}=D_{\phi}$. This can also be seen directly from the construction of $D_{\phi}$ if one takes care.

We see then that $\phi$ is dual to the map $\ox \to \Fe\ox \to \Fe\ox((p^{e}-1)\Delta_{\phi})$. We can study the same kinds of pairs by working with such maps instead. This is the setup of \cite{schwede2010globally} for example.


\begin{lemma}
	
	Two pairs $(\mathcal{L}, \phi)$ and $(\mathcal{L}', \phi')$ are equivalent if and only if $\Delta_{\phi}=\Delta_{\phi'}$. In particular then there is a bijection between equivalence classes of such pairs and $\Delta \geq 0$ with $(K_{X}+\Delta)$ $\zp$-Cartier.
	
	
	\end{lemma}

\begin{proof}
	
	From above we have that if $(\mathcal{L}, \phi)$ and $(\mathcal{L}', \phi')$ are equivalent then $\Delta_{\phi} = \Delta_{\phi'}$ so we prove only the converse statement.
	
	By taking higher powers of these maps we may assume wlog that $e=e'$. This does not change $\Delta_{\phi}$ or $\Delta_{\phi'}$ by \autoref{twist}, moreover the equivalence classes of $(\mathcal{L}, \phi)$ and $(\mathcal{L}', \phi')$ are unchanged by definition.
	
	However if $D=\Delta_{\phi}-\Delta_{\phi'}$ then $(p^{e}-1)D \sim 0$ defines an isomorphism $$i:\ox((p^{e}-1)(K_{X}+\Delta_{\phi}))\to \ox ((p^{e}-1)(K_{X}+\Delta_{\phi'})).$$ Let $\psi=\phi' \circ i$ so we have $\Delta_{\psi}=D+\Delta_{\phi'}=\Delta_{\phi}$ but this says exactly that $\psi=\phi\circ u$ for some automorphism $u$ of $\mathcal{L}$ and hence $(\mathcal{L},\psi)\sim(\mathcal{L'},\phi')$. 
	
\end{proof}

To extend this framework to allow for sub pairs we can instead work with morphisms $\Fe\mathcal{L} \to K(X)$ where we view $K(X)$ as a constant sheaf on $X$. Given such a morphism $\phi$, we can always find $E \geq 0$ Cartier such that when we twist by $E$ we obtain $$\phi':=\Fe(\mathcal{L}((1-p^{e})E)) \to \ox$$ and thus associate a divisor $\Delta_{\phi'}$ with $(1-p^{e})(K_{X}+\Delta_{\phi'})\sim \mathcal{L}((1-p^{e})E$. We then take $\Delta_{\phi}=\Delta_{\phi'}-E$.

\begin{lemma}
	With the notation as above, $\Delta_{\phi}$ does not depend on the choice of $E$.
\end{lemma}
\begin{proof}
	Suppose $E_{1},E_{2}$ are two choices of $E$, suppose wlog that $E_{1} \leq E_{2}$. Write $\phi_{i}:=\Fe(\mathcal{L}((1-p^{e})E_{i})) \to \ox$ for their twists. Let $i$ be the inclusion $\mathcal{L}((1-p^{e})E_{2}) \to\mathcal{L}((1-p^{e})E_{1})$. Then by Lemma \ref{twist} since $\phi_{2}=\phi_{1}\circ F_{*}^{e}i$ we have that $\Delta_{\phi_{2}}=\Delta_{\phi_{1}}+(E_{2}-E_{1})$ so that $\Delta_{\phi_{2}}-E_{2}=\Delta_{\phi_{1}}-E_{1}$.
\end{proof}


\begin{definition}
	A sub $\zp$-pair is a $\kappa$-pair $(X,B)$ where $\kappa$ is $F$-finite, $(K_{X}+B)$ is $\zp$-Cartier and the coefficients of $B$ are less than $1$. We write $\phi_{B}: F_{*}^{e_{B}}\mathcal{L}_{e,B} \to K(X)$ for the associated morphism dropping the dependence on $B$ when it remains clear. If $B$ is effective $(X,B)$ is called a $\zp$ pair and we view $\phi_{B}$ as being a morphism to $\ox$.
	
	Let $(X,B)$ be a (sub) $\zp$ pair, then $(X,B)$ is
	\begin{itemize}
		\item (sub) $F$-pure if $\ox \subseteq \text{Im}(\phi^{e})$ for some $e$
		\item (sub) $F$-split if $1\in\text{Im}(H^{0}(X,\phi^{e}))$ for some $e$
		\item (sub) $F$-regular if for every $D \geq 0$ there is some $e$ with $\ox \subseteq \phi^{e}(\Fe(\mathcal{L}_{e}(-D))$ 
		\item globally (sub) $F$-regular if for every $D \geq 0$ there is some $e$ with $1\in\textup{Im}(H^{0}(X,\phi^{e}|_{\Fe(\mathcal{L}_{e}(-D))})$ 
	\end{itemize}
\end{definition}

\begin{remark}\label{R-Def}
	
	We can also extend the definitions to log pairs in the sense of \autoref{log-pair}. Roughly we speaking we say $(X,\Delta)$ satisfies the definition if there is $B \geq \Delta$ such that $(X,B)$ is a sub $\zp$ pair satisfying the definition in question. Alternatively one can work with reflexive sheaves in the place of line bundles. By \autoref{perturb} the two are equivalent.	
	\end{remark}

Being $F$-split is also sometimes called globally $F$-split, to distinguish it from the case of local splittings.

Some immediate consequences of \autoref{twist} and \autoref{R-twist} are the following.

\begin{lemma}\label{perturb}
	
	Let $(X,\Delta)$ and $(X,B)$ be globally $F$-split pairs. Then for $0 \leq t <<1$ we have that $(X,t\Delta+(1-t)B)$ is $F$-split and for $0 \leq \lambda \leq 1$ we have that $(X,\lambda \Delta)$ is $F$-split also. Moreover if $(X,\Delta)$ is in fact globally $F$-regular then
	
	\begin{enumerate}
		\item $(X,\lambda \Delta)$ is globally $F$-regular for all $0 \leq \lambda \leq 1$.
		\item $(X,t\Delta +(1-t)B)$ is globally $F$-regular for $0 \leq t <<1$.
		\item For any $D \geq 0$, $(X,\Delta+tD)$ is globally $F$-regular for $0 \leq t <<1$. 
		\item $B=\Delta+D$ then $(X,\Delta+tD)$ is globally $F$-regular for $0 \leq t <1$.
	\end{enumerate}

	\end{lemma}

\begin{proof}
	Let $(X,\Delta)$ and $(X,B)$ be globally $F$-split pairs. By composing the associated morphisms $\phi_{\Delta} \colon \Fe \mathcal{L}_{\Delta} \to \ox$ and $\phi_{B} \colon \Fe[e'] \mathcal{L}_{B} \to \ox$ as in \autoref{twist} we obtain a split morphism $\psi=\phi_{\Delta}\circ_{F} \phi_{B}$ with associated divisor $(1-\frac{p^{e}-1}{p^{e+e'}-1})\Delta+ \frac{p^{e}-1}{p^{e+e'}-1}B$. Taking $e'>>e$ yields the result. 
	
	To see that $(X,\lambda \Delta)$ is $F$-split for $\lambda \geq 0$, we can assume $\lambda \in \zp$. Then by \autoref{twist} and the discussion following it, we see that we have a factorisation $$\phi_{\Delta} \colon \Fe \mathcal{L} \to \Fe \mathcal{L}_{\lambda \Delta} \to \ox$$ for $e>>0$. This yields the result.
	
	Now suppose that $(X,\Delta)$ is globally $F$-regular. Then part $(1)$ follows exactly as above. We now prove $(2)$. To this end, let $H$ be a Cartier divisor whose support contains $B$. 
	
	From the definition of globally $F$-regular and previous parts we have small $\epsilon, \delta > 0$ with $(X,\epsilon \Delta +(1-\epsilon)B+\delta H)$ $F$-split. We claim that $(X,\epsilon \Delta +(1-\epsilon)B)$ is globally $F$-regular. Certainly it is $F$-split so let $\phi\colon \mathcal{L} \to \ox$ be the associated morphism. This pair is globally $F$-regular on $U=X\setminus H$, since $H \geq B$. So if we fix $D\geq 0$ then we have a splitting of $\phi_{U}\colon \Fe \mathcal{L}_{U}(-D) \to \ox[U]$, say $i_{U}\colon \ox[U] \to \Fe \mathcal{L}_{U}(-D)$. We now seek to extend $i_{U}$ to an appropriate splitting on $X$.
	
	By \cite[Chapter II, Lemma 5.14(b)]{Ha77} $i_{u}$ extends to a section $i:\ox \to (\Fe \mathcal{L}) \otimes \ox(mH)$ such that the following composition 
	\[\ox \xrightarrow{i} (\Fe \mathcal{L}(-D)) \otimes \ox(mH) \xrightarrow{\phi\otimes\ox(mH)} \ox(mH)\]
	
	is natural inclusion $\ox \to \ox(mH)$ induced by $H$. Tensoring by $\ox(-mH)$ yields
	\[\ox(-mH) \xrightarrow{i\otimes \ox(-mH)} \Fe \mathcal{L}(-D) \xrightarrow{\phi} \ox.\]
	Again this is the natural inclusion of $\ox(-mH)$ into $\ox$. Finally we tensor by $\Fe[e']\mathcal{L}$ to yield
	$$\Fe[e']\mathcal{L}(-mH) \to \Fe[e'+e]\mathcal{L}(-D) \to \Fe[e']\mathcal{L}.$$
	By assumption, for $e'>>0$ the morphism $\Fe[e']\mathcal{L}(-mH) \to  \Fe[e']\mathcal{L} \to \ox$ splits. Hence so too does $\Fe[e'+e]\mathcal{L}(-D) \to \Fe[e']\mathcal{L} \to \ox$. Thus $(X,\epsilon \Delta +(1-\epsilon)B)$ is globally $F$-regular as claimed.
		
	Now for $(3)$ fix a $D \geq 0$. Then $$\Fe \mathcal{L}(-D) \to \Fe \mathcal{L}(-D) \to \ox $$ splits for $e>>0$. The associated divisor is precisely $(X,\Delta+\frac{1}{p^{e}-1}D)$ so $(X,\Delta+tD)$ is $F$-split for small $t$. By (1) with $B=\Delta+tD$, we may shrink $t$ and assume the pair is globally $F$-regular. 
	
	The final part follows straight from $(2)$ since $t\Delta+(1-t)B=\Delta+(1-t)D$.
	
\end{proof}
Locally to a point of codimension $1$ these definitions are particularly well-behaved.
\begin{lemma}
	Let $R$ be a regular DVR with parameter $t$, then a sub $\zp$ pair $(R,\lambda t)$ is sub $F$-pure iff $\lambda \leq 1$ and sub $F$-regular iff $\lambda < 1$.
\end{lemma}

\begin{proof}
	
	After choosing an isomorphism $\mathcal{L}\simeq R$ we may suppose that $\lambda t$ defines a morphism $\Fe R \to R$. By \autoref{R-twist} this factors $\Fe R \to <t> \to R$ if and only if $\Delta_{\phi} \geq \frac{p^{e}}{p^{e-1}}t$. This happens for $e>>0$ if and only if $\lambda > 1$. This gives the $F$-pure case.
	
	Since every divisor $D$ on $R$ is of the form $\mu t$, for $\mu$ a unit, the $F$-regular result follows also.
\end{proof}

%\begin{proof}
%	Suppose first that $\lambda > 1$. Then for any $e >0$ we have $(p^{e}-1)\lambda >(p^{e}-1)$ and hence if $(p^{e}-1)\lambda t$ is Cartier, we must have $(p^{e}-1)\lambda t \geq p^{e} t$. Fix an $e$ then with $(p^{e}-1)\lambda t$ Cartier and an isomorphism $K_{X}\sim R$. Then we may view $\phi: \Fe <t^{(p^{e}-1)\lambda}> \to R$ as a factoring through $C^{e}: \Fe R \to R$ where $C\colon f_{*}R \to R$ is the morphism associated to the zero divisor. In particular then as $C^{e}$ is $R$ linear and $\Fe <t^{(p^{e}-1)\lambda}> \subseteq t.\Fe R$ it follows $\phi(\Fe <t^{(p^{e}-1)\lambda}> ) \subseteq <t>$, so the pair cannot be $F$-pure.
%	Now suppose $\lambda \leq 1$.
%%	 in fact it is sufficient to assume $\lambda =1$.
%
%	Let $C^{e}:\Fe R \to R$ be the generating map, then take $x_{1},...,x_{n}$ a basis of $\Fe R$ over $R$. Suppose $I$ is an ideal of $R$ with $C^{e}(\phi(I)) \subseteq <t>$ then $\Fe I \subseteq \oplus <t>.x_{i} =<t>.\Fe S= \Fe <t^{p^{e}}>$. In particular then if $\lambda \leq 1$ we see that  $<t^{(p^{e}-1)}>\not\subseteq <t^{p^{e}}>$ so $C^{e}(<t^{(p^{e}-1)}>) \not\subseteq <t>$. However this ensures that $(R,t)$ is $f$-pure and hence $(X,\lambda t)$ is sub $F$-regular for any $\lambda <1$.   
%	\end{proof}
In particular we see that the coefficient of $\Delta_{\phi}$ at $E$ depends only on $\phi$ near $E$.

\begin{corollary}\label{local}
	Suppose $\phi:\Fe\mathcal{L} \to k(X)$ has associated divisor $\Delta$ then $\text{Coeff}_{E}(\Delta)=\inf\{t: (X,\Delta+tE) \text{is } F \text{ sub pure at the generic point of } E\}$. 
\end{corollary}

While these definitions do not pullback along birational morphisms as obviously as the usual MMP singularities, it is still possible.

\begin{lemma}\label{F-pullback}
	Suppose that $f\colon X \to Y$ is a birational morphism with $X$ normal and $(Y,\Delta)$ $\zp$ pair then there is $\Delta'$ on $X$ making $(X,\Delta')$ a $\zp$ pair such that $(K_{X}+\Delta')=f^{*}(K_{Y}+\Delta)$.  If $(Y,\Delta)$ is sub $F$-split so too is $(X,\Delta')$.
\end{lemma}
\begin{proof}
	
	Take the corresponding map $\phi\colon \Fe\mathcal{L} \to K(Y)$, we may freely view $\mathcal{L}$ as a subsheaf of $K(Y)$ via some $i \colon \mathcal{L} \hookrightarrow K(Y)$ and so extend $\phi$ to a map $\bar{\phi}\colon \Fe K(Y) \to K(Y)$. Taking the inverse image gives $f^{-1}(\bar{\phi})\colon f^{-1}\Fe K(Y) \to f^{-1}K(Y)$ and $f^{-1}(i) \colon f^{-1}\Fe \mathcal{L} \to f^{-1}K(Y)$. Since $f$ is birational we obtain an isomorphism $f^{-1}K(Y) \to K(X)$. We then have the following situation.
	\[\begin{tikzcd}
	f^{-1}\Fe(\mathcal{L}) \otimes_{f^{-1}\Fe\mathcal{O}_{Y}}\ox \arrow[r, hook] & \Fe K(X) \arrow[r]                                          & K(X)                                \\
	f^{-1}\Fe(\mathcal{L}) \arrow[r, hook, "f^{-1}(i)"] \arrow[u, hook]                       & f^{-1}\Fe K(Y) \arrow[r, "f^{-1}(\bar{\phi})"'] \arrow[u, "\sim"] & f^{-1}K(Y) \arrow[u, "\sim", hook']
	\end{tikzcd}\]
	
	Note however that $f^{-1}\Fe(\mathcal{L}) \otimes_{f^{-1}\Fe\mathcal{O}_{Y}}\ox= \Fe f^{*}\mathcal{L}$ and hence we obtain the desired map $\tilde{\phi}: \Fe f^{*}\mathcal{L} \to K(X)$. This induces a divisor $\Delta'$ on $X$ with $(p^{e}-1)(K_{X}+\Delta') \sim f^{*}\mathcal{L} \sim (p^{e}-1)f^{*}(K_{Y}+\Delta)$. The coefficient of $\Delta'$ at a codimension one point can be recovered from $\tilde{\phi}$ by working locally around that point. wherever $f$ is an isomorphism, $\phi$ and $\tilde{\phi}$W agree and therefore the coefficients of $\Delta$ and $\Delta'$ agree on this locus also.
	
	Hence in fact we have an actual equality of divisors $f^{*}(K_{Y}+\Delta)=(K_{X}+\Delta')$ as required. Moreover commutativity of the earlier diagram gives that whenever $1 \in \text{Im}(H^{0}(Y,\phi))$ then it is also in the image of $H^{0}(X,\tilde{\phi})$, and hence $(X,\Delta)$ is sub $F$-split.
\end{proof}

Note that a pair $(X,\Delta)$ is sub $F$-pure if and only if there is an open cover $\{U_{i}\}$ with $(U_{i},\Delta|_{U_{i}})$ sub $F$-split. Hence in fact this shows we may also lift sub $F$-pure pairs in the same fashion. 

Similarly a pair $(X,\Delta)$ is (globally) sub $F$-regular if and only if for every $D \geq 0$ there is $\epsilon<0$ with $(X,\Delta+\epsilon D)$ sub $F$-pure ($F$-split). Further if $f\colon Y \to X$ is birational with $D \geq 0$ on $Y$ there is always some $D' \geq 0$ on $X$  with $f^{*}D' \geq D$. Therefore pulling back $(X,\Delta +\epsilon D')$ to $(Y,\Delta'+\epsilon f^{*}D')$ we see that  $(Y,\Delta'+\epsilon D)$ is sub $F$-pure ($F$-split)and so $(Y,\Delta')$ is (globally) sub $F$-regular.


\begin{theorem}
	
	Let $(X,\Delta)$ be a sub $F$-pure pair. Then $(X,\Delta)$ is sub-lc. Moreover if $(X,\Delta)$ is sub $F$-regular then in fact it is sub-klt.
	
\end{theorem}

\begin{proof}
		Let $Y \to X$ be a proepr birational morphism of integral normal schemes and $\Delta_{Y}$ the induced boundary on $Y$. From above we see that $(Y,\Delta_{Y})$ is sub $F$-pure. However by \autoref{local} we see that this ensures $\text{Coeff}_{D}(\Delta_{Y}) \leq 1$ for every prime divisor $D$ on $X$. Hence $(Y,\Delta_{Y})$ is sub-lc and therefore so too is $(X,\Delta)$. An identical calculation completes the $F$-regular case.
\end{proof}

In general we cannot push forward the local forms of these singularities, however the global ones often can be pushed forward, even along morphisms which are not birational. 

\begin{lemma}
	Suppose that $(X,\Delta)$ is sub $F$-split and $f\colon X \to Y$ has $f_{*}\ox =\mathcal{O}_{Y}$ and $K_{X}+\Delta \sim_{\zp} f^{*}\mathcal{L}$. If every component of $\Delta$ which dominates $Y$ is effective then there is $\Delta_{Y}$ with $(Y,\Delta_{Y})$ sub $F$-split and $K_{Y}+\Delta_{Y} \sim_{\zp} \mathcal{L}$.
\end{lemma}

\begin{proof}
	
	This is the inverse construction of \autoref{F-pullback}. By assumption the pair $(X,\Delta)$ corresponds to a morphism $\phi\colon F_{*}^{e}f^{*}\mathcal{L} \to K(X)$. Since the dominant part of $\Delta$ is effective we may view this as a morphism $\phi: f^{*}\mathcal{L} \to f^{*}\ox(D)$ where $D$ is some divisor on $Y$ with $(1-p^{e}) \Delta \geq -f^{*}D$.
	
	This then pushes forward to a non-zero morphism $\phi_{Y}:F_{*}^{e}\mathcal{L} \to \ox[Y](D) \subseteq K(Y)$ which canonically induces a pair $(Y,\Delta_{Y})$. Note further that we have natural isomorphisms

	\[\begin{tikzcd}
	{H^{0}(X,F_{*}^{e}f^{*}\mathcal{L})} \arrow[r, "H^{0}(\phi^{e})"] \arrow[d, "\simeq "] & {H^{0}(X,f^{*}\ox[Y](D))} \arrow[d, "\simeq"] \\
	{H^{0}(Y,F_{*}^{e}\mathcal{L})} \arrow[r, "H^{0}(\phi_{Y}^{e})"]                       & {H^{0}(Y,\ox[Y](D))}                         
	\end{tikzcd}\]
	
	so that $(X,\Delta)$ is sub $F$-split if and only if $(Y,\Delta_{Y})$ is so.	
\end{proof}

If in fact $(X,\Delta)$ is globally $F$-regular then so too is $(Y,\Delta_{Y})$. Indeed if $D$ is a divisor on $Y$, then there is $\epsilon > 0$ with $(X,\Delta+\epsilon f^{*}D)$ globally $F$-split but then $(Y,\Delta+\epsilon D)$ is globally $F$-split also.

By Corollary \ref{local} if $f\colon X \to Y$ is birational then the conditions are automatically satisfied and the induced $\Delta_{Y}$ is just the pushforward $f_{*}\Delta$. Therefore if $X$ is sub $F$-split so is every $X'$ birational to $X$. Further if $X$ is $F$-split and $X'$ is obtained by taking a terminalisation or running a $K_{X}+B$ MMP for any $B$ then $X'$ is $F$-split.

\subsubsection{Global Frobenius Singularities}

Pairs $(X,\Delta)$ which are globally $F$-split or globally $F$-regular can always be modified slightly to assume a particularly nice form.

\begin{lemma}
	
	Suppose that $(X,\Delta)$ is a globally $F$-split pair, then we have $\Delta' \geq \Delta$ such that $(X,\Delta')$ is globally $F$-split and $K_{X}+\Delta \sim_{\zp} 0 $.
	
	If instead $(X,\Delta)$ is globally $F$-regular, then we have $\Delta' \geq \Delta$ such that $(X,\Delta')$ is globally $F$-regular and $-(K_{X}+\Delta)$ is ample.
	
	\end{lemma}

\begin{proof}
	Suppose $(X,\Delta)$ is a globally $F$-split $\zp$ pair. Let $\phi\colon F_{*}^{e}\mathcal{L} \to \ox$ be the corresponding morphism with $1 \in \im(H^{0}(\phi))$. Then by assumption we have a section $s:\ox \to F_{*}^{e}\mathcal{L}$ which is a splitting of $\phi$. 
	
	However we get an induced section $F_{*}^{e} \ox \to F_{*}^{e}\mathcal{L}$ given locally by $r \to r\times s(1)$, hence in fact $s$ factors $s: \ox \to F_{*}^{e}\ox \to F_{*}^{e}\mathcal{L}$. The composition $\Fe \ox \to \Fe \mathcal{L} \to \ox$ induces an $F$-split pair $(X,\Delta')$ with $K_{X}+\Delta' \sim_{\zp} 0$. Moreover we have $\Delta' \geq \Delta$ by \autoref{R-twist}.
		
	Now suppose that $(X,\Delta)$ is a globally $F$-regular $\zp$ pair. First, from above, we may take $B$ with $(X,\Delta+B)$ $F$-split and $K_{X}+\Delta+B \sim_{\zp} 0$.
	
	Now choose $H\geq B$ an ample divisor. Then we have that the composition $\Fe \mathcal{L}(-H) \to \Fe \ox \xrightarrow{\phi} \ox$ splits. As before the section $\ox \to \mathcal{L}(-H)$ factors $\ox \to \Fe\ox(-H) \to \Fe \mathcal{L}(H)$. The split morphism $\Fe\ox(-H) \to \ox$ induces a globally $F$-split pair $(X,\Delta+D)$ with $K_{X}+\Delta+D \sim_{\zp} \delta H$ where $\delta=\frac{1}{p^{e}-1}$. Moreover the first part of the lemma applied to $(X,\Delta+D)$ yields the $F$-split pair $(X,\Delta+D+\delta H)$, again by \autoref{R-twist}.
	
	We now apply \autoref{perturb} to $(X,\Delta+B)$ and $(X,\Delta+D+\delta H)$ to see that $(X,\Delta+ tD + (1-t+\delta')B)$ is $F$-split. By the same lemma we can choose $t$ small enough that $(X,\Delta+tD)$ is globally $F$-regular. Applying the lemma one more time to these two new pairs, we see that $(X,\Delta+tD+(1-t)B)$ is globally $F$-regular. By construction this pair has $K_{X}+\Delta+tD+(1-t)B \sim_{\zp} -tH$ as required. 
		
\end{proof}

\begin{lemma}\label{vanish}
	
	Let $(X,\Delta)$ be a globally $F$-split pair. Then $H^{i}(X,K_{X}+\Delta+A)=0$ for $A$ an ample $\mathbb{Q}$-Cartier divisor and $i> 0$. In particular $H^{i}(X,A)=0$ for $i> 0$. Moreover if $(X,\Delta)$ is globally $F$-regular then we may suppose only that $A$ is big and nef instead.
	
	\end{lemma}

\begin{proof}
	
	Suppose first that $(X,\Delta)$ is $F$-split and $A$ is ample. Then we have a split map $\Fe \mathcal{L} \to \ox$ where $\mathcal{L}=\ox((1-p^{e})(K_{X}+\Delta))$. Tensoring by $\ox(K_{X}+\Delta+A)$ yields $\Fe\ox(K_{X}+\Delta+p^{e}A) \to \ox(K_{X}+\Delta+A)$. Taking cohomology then gives a surjection $H^{i}(X,K_{X}+\Delta+p^{e}A) \to H^{i}(X,K_{X}+\Delta+A)$ for $i \geq 0$ where the left hand side vanishes for $e>>0$ and $i>0$ by Serre vanishing. Hence in fact $H^{i}(X,K_{X}+\Delta+A)=0$ as claimed. From above, we can assume that $K_{X}+\Delta\sim\_{\zp} 0$, so we have $A'$ ample with $K_{X}+\Delta+A'=A$ and the second part follows.
	
	Now suppose that $(X,\Delta)$ is globally $F$-regular. Choose $E\geq 0$ with $nA-E$ ample for $n>>0$. Then we have $\Fe\mathcal{L}(-E) \to \ox$ split. Again we tensor by $K_{X}+\Delta+A$ to yield a split map $\Fe \ox(K_{X}+\Delta+p^{e}A-E) \to \ox(K_{X}+\Delta+A)$. From the first part, the cohomology of $\ox(K_{X}+\Delta+p^{e}A-E)$ vanishes for $e>>0$ and the result follows.
		
\end{proof}

If $(X,\Delta)$ is $F$-split (resp. globally $F$-regular) in the sense of \autoref{R-Def} one needs to be slightly more careful. In this case we have a $\zp$ pair $(X,B)$ with $B \geq 0$ and $\mathcal{L}=\ox((1-p^{e})(K_{X}+B))$ which is $F$-split (resp. globally $F$-regular). Then the morphism $\Fe \mathcal{L} \to \ox$ must factor $\Fe \mathcal{L} \to \Fe\ox((1-p^{e})(K_{X}+\Delta) \to \ox$, as in \autoref{perturb} and the result follows exactly as above.

\section{The Minimal Model Program}\label{overview}

\subsection{Overview of the Minimal Model Program}\label{sub-overview}

In it's original incarnation the Minimal Model Program seeks to modify a smooth complex variety to a simpler (or minimal) birational model. The last few decades have seen a shift away from this paradigm, however. 

The Minimal Model Program now consists of a suite of useful tools in its own right, focused on the birational modification of pairs $R$-pairs $(X,B)/T$ over a suitable base, and having mild singularities - typically $\mathbb{Q}$-factorial and klt, or more generally dlt or log canonical singularities might be permitted. We will focus mainly on the klt case here.

The acronym MMP is often used to refer to both the specific process of running a series of birational modifications to a pair as well as the overall research area. For the avoidance of confusion MMP will be refer to the process and Minimal Model Program to the area of study.

The key structural result of the Minimal Model Program is the Cone Theorem. In its most general form we might expect the following.

\begin{conjecture}[Cone Theorem]\label{cone-conj}
	Take an excellent ring $R$ admitting a dualising complex.
	Let $(X,\Delta)/T$ be a dlt $\mathbb{Q}$-factorial $R$-pair of dimension $n$. Then there is a countable collection of curves $\{C_{i}\}$ on $X$ such that:
	\begin{enumerate}
		\item $$\overline{NE}(X/T)=\overline{NE}(X/T)_{K_{Y}+\Delta \geq 0} + \sum_{i} \mathbb{R}[C_{i}]$$
		\item The rays $C_{i}$ do not accumulate in $(K_{Y}+\Delta)_{<0}$.
		\item For each $i$ there is $d_{C_{i}}$ with 
		\[0 < -(K_{X}+\Delta).C_{i} \leq 2nd_{c_{i}}\]
		and $d_{C_{i}}$ divides $L\cdot_{k}C_{i}$ for every Cartier divisor $L$ on $X$.
	\end{enumerate}
\end{conjecture}

If the field is algebraically closed we can take $d_{C_{i}}=1$ for every $i$, but not in general even if the field is perfect. See for example \cite[Example 7.3]{tanaka2018behavior}.

An MMP is then run by contracting extremal $K_{X}+\Delta$ negative curves. The existence of such contractions is a key application of the Basepoint Free Theorem.

\begin{conjecture}[Basepoint Free Theorem]\label{bpt-conj}
	Let $(X,\Delta)/T$ be a klt $R$-pair. Suppose that $D$ is a $\mathbb{Q}$-Cartier divisor, nef over $T$, such that $D-(K_{X}+\Delta)$ is big and nef over $T$. Then $D$ is semiample.
\end{conjecture}

When we contract an extremal ray via $\phi\colon X \to X'$ we have three mutually exclusive possibilities.

\begin{enumerate}
	\item Mori Fibration: $\dim X' < \dim X$ and $\phi$ is a $K_{X}+\Delta$ negative fibration of relative Picard rank $1$
	\item Divisorial Contraction: $\phi$ contracts exactly one prime divisor on $X$
	\item Flipping (or Small) Contraction: $\phi$ contracts a locus of codimension at least $2$
\end{enumerate}

The first case is considered an output of the MMP and the process terminates here. If the second occurs then the process may continue unobstructed. The final case, however, always yields a very singular $X'$. In particular since the dimension of $N^{1}(X/T)$ falls but no Weil Divisor is contracted, $X'$ cannot be $\mathbb{Q}$-factorial.

The solution to this is to construct a flip. This is a pair $(X^{+},\Delta^{+})$ admitting a small $K_{X^{+}} +\Delta^{+}$ positive contraction $\phi^{+}:X^{+} \to X'$ of relative Picard rank $1$ such that the $\Delta ^{+}$ is the strict transform of $\Delta$ under the induced map $X \dashrightarrow X^{+}$.

\begin{conjecture}[Existence of flips]\label{flips-conj}
	Let $(X,\Delta)/T$ be a klt $R$-pair and suppose $\phi\colon X \to Z$ is a $(K_{X}+\Delta)$ negative flipping contraction. Then there exists a flip. \[\begin{tikzcd}
	X \arrow[rr, dotted] \arrow[rd, "\phi"] &   & X^{+} \arrow[ld, "\phi^{+}"] \\
	& Z &                             
	\end{tikzcd}\]	
\end{conjecture}

Divisorial contractions always reduce the Picard rank, so there can only be finitely many. Flips, however, do not have such a clearly associated invariant and it is not immediately clear that there can be no infinite sequence of flips. Nonetheless this is expected to be true.

\begin{conjecture}[Termination of flips]
	
	Let $(X,\Delta)/T$ be a $\mathbb{Q}$-factorial klt $R$-pair. Then there is no infinite sequence of $(K_{X}+\Delta)$ flips $X \dashrightarrow X_{1} \dashrightarrow ...$ over $T$.
	
	\end{conjecture}

Together these conjectures form the key results of the Minimal Model Program and are sufficient to run a terminating MMP from any klt pair. The output $(Y,B)$ of any such MMP can be one of two things.

\begin{enumerate}
	\item Minimal Model: $K_{Y}+B$ is nef
	\item Mori Fibre Space: $Y$ admits a $K_{Y}+B$ negative Mori Fibration
\end{enumerate}
A closely related conjecture is the following

\begin{conjecture}[Special termination]
	
	Let $(X,\Delta)/T$ be a $\mathbb{Q}$-factorial dlt $R$-pair. Then there is no infinite sequence of $(K_{X}+\Delta)$ flips $X \dashrightarrow X_{1} \dashrightarrow ...$ over $T$ whose flipping or flipped locus meet $\lfloor \Delta \rfloor$.
	
\end{conjecture}

By \cite[4.2.1]{fujino2007special}, this holds in dimension $n$ if termination of flips holds in dimensions $\leq n-1$.

For threefolds over a positive dimensional base, the current state of the art is the following:

	\begin{theorem}\cite{bhatt2020}\label{MMP}
	Let $(X, \Delta)/T$ be a $\mathbb{Q}$-factorial three-dimensional dlt pair over a ring $R$. Suppose that the closed points of $R$ have residue field of characteristic $p=0$ or $p> 5$. Suppose further that $\dim T >0$. Then the Cone and Basepoint Free Theorems hold.
	
	Moreover there exists a $(K_X+\Delta)$-MMP over $T$ that terminates. If $K_{X}+\Delta$ is pseudo-effective then every MMP terminates.
	
	In particular there is a sequence of birational maps of three-dimensional integral, normal and $\mathbb{Q}$-factorial schemes:  
	\[
	X=:X_0 \overset{\varphi_0}{\dashrightarrow} X_1 \overset{\varphi_1}{\dashrightarrow} \cdots \overset{\varphi_{\ell-1}}{\dashrightarrow} X_{\ell}
	\]
	such that if $\Delta_i$ denotes the strict transform of $\Delta$ on $X_i$, then
	the following properties hold:  
	\begin{enumerate}
		\item 
		For any $i \in \{0, \ldots, \ell\}$, 
		$(X_i, \Delta_i)$ is dlt, $\mathbb{Q}$-factorial and projective over $Z$.
		\item 
		For any $i \in \{0, \ldots, \ell-1\}$, 
		$\varphi_i\colon X_i \dashrightarrow X_{i+1}$ is either a $(K_{X_i}+\Delta_i)$-divisorial contraction over $Z$ or a $(K_{X_i}+\Delta_i)$-flip over $Z$. 
		\item 
		If $K_X+\Delta$ is pseudo-effective over $Z$, then $K_{X_{\ell}}+\Delta_{\ell}$ is nef over $Z$. 
		\item 
		If $K_X+\Delta$ is not pseudo-effective over $Z$, then 
		there exists a $(K_{X_{\ell}}+\Delta_{\ell})$-Mori fibre space $X_{\ell} \to Y$ over $Z$. 
	\end{enumerate}
\end{theorem}

Over a positive characteristic field slightly less is known, even if the field is algebraically closed. 

	\begin{theorem}\cite[Theorem 1.7]{BW17}\cite{Bir16}\cite[Theorem 1.6]{waldron2018lmmp}\cite[Proposition 6.7]{hashizume2017minimal}\label{p-MMP}
	Let $(X, \Delta)$ be a $\mathbb{Q}$-factorial three-dimensional dlt pair, projective over a closed field $\kappa$. Suppose that $\kappa$ has characteristic $p> 5$, then the Cone and Basepoint Free Theorems hold.
	
	Moreover there exists a $(K_X+\Delta)$-MMP over $\kappa$ that terminates. Moreover if $K_{X}+\Delta$ is effective then every MMP terminates.

\end{theorem}

Note that by \cite[Theorem 2]{witaszek2017canonical}, if $(X,\Delta)$ is klt and $K_{X}+\Delta$ is pseudo-effective then in fact $K_{X}+\Delta$ is effective.
These results extend more generally to the case that $\kappa$ is a perfect field by base change.

Terminating MMP's can also be run for certain fourfolds birational to their base or semistable over a curve \cite{hacon2020relative}. Some of the conjectures of the MMP and the existence of log terminal models are also known for threefold pairs over an imperfect field \cite{das2019log} or over perfect characteristic five fields \cite{hacon2019minimal}. Finally many results are also known in the log canonical setting due to \cite{waldron2018lmmp}, \cite{hashizume2017minimal}.


\subsection{Birational Modifications}\label{subsec-mod}

A particularly useful application of the Minimal Model Program is to find modifications with suitably mild singularities. We will explore some of these modifications and their consequences in this section. In particular we always assume the existence of log resolutions as well as the conjectures of \autoref{sub-overview}. 

We can largely avoid termination arguments, i.e. termination of klt flips and special termination. This is done where possible, largely for the sake of generality. For the results of this section to hold, it suffices to know only that an MMP with scaling terminates for klt $R$-pairs $(X,B)/T$ with $K_{X}+B$ pseudo-effective and $B$ big. 

In fact slightly less is likely fine - that such pairs have a log terminal model (see \autoref{Model-defs}). If $R$ is not of finite type over a field then some care is needed. In some places we would like to take a log terminal model for pairs which are only rlt (see \autoref{rlt-section}). It is not immediate that such models exists, even if they do for each witness, though in practice one would not expect this to be an issue. Some modifications to \autoref{WLC} would also be needed with such assumptions.

In any case, the required results are all known in the settings of \autoref{p-MMP} and \autoref{MMP}, which is where we will apply them. They also hold on any excellent surface pair by \cite{tanaka2018minimal}, which is needed for some inductive arguments. Finally, they are also satisfied if $R$ is a field of characteristic $0$ by \cite{BCHM10}. This will never be needed but provides a natural motivation for assumptions.

A vital ingredient in these results is the negativity lemma, \autoref{negatvity}.

The approach for all the modifications is the same - take a log resolution, choose a suitable pair on the resolution, run an MMP for this new pair. We typically then conclude it is a crepant modification, in some sense, using the negativity lemma. We begin with the case of terminalisation.

%\begin{lemma}
%	
%	Let $(X,\Delta)/T$ be an $R$ pair with $\lfloor \Delta \rfloor =0$. Then there is a terminal pair $(Y,B)$ admitting a birational morphism, called a terminalisation, $\pi\colon Y \to X$ with $B=\pi_{*}^{-1}\Delta$ and $K_{Y}+B$ $\pi$-nef.
%	
%	\end{lemma}



%\begin{proof}
%	
%	Let $f\colon Y' \to X$ be a log resolution of $(X,\Delta)$ such that $f^{*}(K_{X}+\Delta)=(K_{Y'}+\Delta')$ and the strict transform of $\Delta$ has disjoint components. Write $\Delta'=B'+E$ where $B'$ is the strict transform of $\Delta$ and $E$ is exceptional. Then $(Y',B')$ is terminal, since it is is log smooth with coefficients less than $1$ and disjoint support. We may then run a $K_{Y'}+B$ MMP on $Y'$ over $X$. Let $\pi:(Y,B) \to X$ be the output. 
%	
%	Let $F=(K_{Y}+B)-\pi^{*}(K_{X}+\Delta)$, then by construction $\pi_{*}F=f_{*}E=0$ and $F$ is nef over $X$. Hence by the negativity lemma we have that $-F \geq 0$. On the other hand $F$ is precisely the pushforward of $E$ and hence $F \geq 0$, forcing $F=0$ and so $K_{Y}+B=\pi^{*}(K_{X}+\Delta)$ as claimed.
%
%\end{proof}

\begin{lemma}\label{term-mod}
	
	Let $(X,\Delta)/T$ be a klt $R$-pair Then there is a terminal pair $(Y,\Delta_{Y})$ admitting a birational morphism, called a terminalisation, $\pi\colon Y \to X$ with $\pi^{*}(K_{X}+\Delta)=K_{Y}+\Delta_{Y}$.
	
\end{lemma}

\begin{proof}
	
	Let $f \colon Y' \to X$ be a log resolution extracting every divisor with discrepancy at most $0$. Write $f^{*}(K_{X}+\Delta)+E=K_{Y'}+\Delta_{Y'}$ where $E$ is exceptional and $E, \Delta_{Y'} \geq 0$ share no support. Blowing up further, if needed, we can assume that $\Delta_{Y'}$ has disjoint support, so that $(Y',\Delta_{Y'})$ is terminal.
	
	Then we can run a $K_{Y'}+\Delta_{Y'}$ MMP over $X$ to get $\phi \colon Y \dashrightarrow Y'$ where $\pi \colon Y \to X$ has $(Y,\Delta_{Y})$ terminal and $K_{Y}+B_{Y}$ $\pi$ nef. By negativity, $G=\pi^{*}(K_{X}+\Delta)-K_{Y}+\Delta_{Y}$ has $G \geq 0$, since $G$ is exceptional and $-G$ is $\pi$-nef. On the other hand $G=\phi_{*}E$, so $G \geq 0$. Thus $G=0$ and we have $K_{Y}+\Delta_{Y}=\pi^{*}(K_{X}+\Delta)$ as required.
	
%	Now take any $\Delta$ with $(X,\Delta)$ klt. Then by adding a small ample divisor we get $\Delta' \geq \Delta$ such that $(X,\Delta')$ has no valuations with discrepancy exactly $0$. Thus there is $\pi \colon Y \to X$ with $(Y,B'_{Y})$ terminal and $K_{Y}+B'_{Y}=\pi^{*}(K_{X}+\Delta')$. However then we have $K_{Y}+B_{Y}=\pi^{*}(K_{X}+\Delta)$ with $B_{Y} \leq B'_{Y}$ so it must be that $(Y,B_{Y})$ is nef

\end{proof}

%\begin{remark}
%	
%	One can also seek a terminalisation of a pair in a more general sense, looking simply for $\pi\colon Y \to X$ with $(Y,\pi_{*}^{-1}\Delta)$ terminal, but this is not a crepant modification. If $\lfloor \Delta \rfloor=0$ then we can run the above MMP with $f^{-1}_{*}\Delta$ in place of $\Delta'$ to yield such a pair.
%	
%	\end{remark}

%\begin{remark}
%	Of course this is not crepant for $(X,B)$. However the main usage is to take a terminalisation of the underlying variety $X$. Then we have $\pi \colon Y \to X$ with $K_{Y}$ nef, so $B_{Y}=\pi^{*}(K_{X}+B)-K_{Y} \geq 0$ by negativity. 
%	
%	Alternatively, if $(X,\Delta)$ is klt then there are only finitely many valuations with discrepancy $\leq 0$. We can then extract these in a similar fashion to \autoref{dlt-mod}. This gives a crepant terminal model $(Y,B_{Y}) \to (X,\Delta)$. See further \cite[Corollary 1.4.3]{BCHM10}.
%	
%\end{remark}

Perhaps the most useful form of modification is a dlt modification. The main difficulty versus a terminalisation arises from the need to run an MMP for a pair which is not klt. The following proof comes from \cite[Theorem 10.4]{fujino2009fundamental}, but is largely due to Hacon.

\begin{theorem}\label{dlt-mod}
	Let $(X,\Delta)$ an $R$ pair with coefficients bounded above by $1$. Write $\Delta'$ for the divisor with $\textup{Coeff}_{E}(\Delta')=\textup{Min}(\textup{Coeff}_{E}(\Delta),1)$. Then there is a birational morphism $f\colon Y \to X$, called a dlt modification, such that the following holds:
	\begin{itemize}
		\item $Y$ is $\mathbb{Q}$-factorial,
		\item $a(E,X,\Delta) \leq -1$ for every $f$ exceptional divisor $E$,
		\item If $\Delta_{Y}=f^{-1}_{*}\Delta' + \sum_{E \textup{ exceptional}} E$ then $(Y,\Delta_{Y})$ is dlt, and
		\item $K_{Y}+\Delta_{Y}+F=f^{*}(K_{X}+\Delta)$ where $F= \sum_{E\colon a(E,X,\Delta)<-1} -(a(E,X,\Delta)+1)E$.
	\end{itemize}
	Here $\textup{Nklt}(Y,\Delta_{Y})=f^{-1}(\textup{Nklt}(X,\Delta))$, $\text{Supp}(F)=f^{-1}(\textup{Nlc}(X,\Delta))$ and $f_{*}F=\Delta-\Delta'$. Moreover if $(X,\Delta)$ is plt then this is a small morphism.
\end{theorem}

\begin{proof}
	
%	It is sufficient to prove this under the assumption that $\Delta'=\Delta$. Indeed if $(Y,\Delta_{Y})$ is a dlt modification of $(X,\Delta')$ then it is also a dlt modification of $(X,\Delta)$. We need only replace $F$ with $F'=F+f^{*}(\Delta-\Delta')$. Then explicit calculation shows that 
%	\[\text{Coeff}_{E}(F')=-(a(E,X,\Delta)+1).\]
%	Indeed if $E$ is exceptional, this is immediate since $$K_{Y}+f^{-1}_{*}\Delta'+\sum_{E \text{ exceptional}}E +F' = K_{Y} + \sum -a(E,X,\Delta)E$$
%	and $f^{-1}_{*}\Delta$ is not supported on $E$. If $E$ is not exceptional, then we may assume $\text{Coeff}_{f_{*}E}\Delta \geq 1$. Thus $\text{Coeff}_{E}F'=\text{Coeff}_{f_{*}E}\Delta - \text{Coeff}_{f_{*}E}\Delta'=-(a(E,X,\Delta)+1)$ as claimed. 
	
	Take a log resolution $\pi\colon Y \to X$ of $(X,\Delta)$ admitting an ample exceptional divisor $-C$, which exists by \cite[Theorem 1]{kollar2021resolution}. Note that by the negativity lemma, as $-C$ is nef we have that $C \geq 0$, justifying the choice of sign.
	
	Roughly speaking we would like to say that $\pi^{*}(K_{X}+\Delta)=K_{Y}+\pi_{*}^{-1}\Delta'+E$ and run an MMP for the dlt pair $(Y,S+\pi_{*}^{-1}\Delta')$ where $S=\text{Supp}(E)$. Indeed, if such an MMP exists, then we can replace $Y$ with the output so that $N=\pi^{*}(K_{X}+\Delta)-(K_{Y}+E+\pi_{*}^{-1}\Delta')= \pi_{*}^{-1}(\Delta-\Delta')+(E-F)$ has $\pi_{*}N=\Delta-\Delta' \geq 0$ and $-N$ nef. That is, $N \geq 0$ by the negativity lemma and the result follows immediately taking $F=N$.  
	
	When this MMP is not known to exist, the same result is achieved by making small perturbations by suitable ample divisors. In general we do not have sufficiently strong Bertini theorems to create klt pairs from such perturbations. However they are always rlt by \autoref{bertini}. This is sufficient to run a terminating MMP, see further \autoref{rlt-section}.
	
	To this end, let \[D= \sum_{\substack{E \text{exceptional} \\ a(E,X,\Delta) > -1}} E\]
	and 
		\[G = \sum_{\substack{E \\ a(E,X,\Delta) \leq  -1}} -a(E,X,\Delta)E\]
	Let $S$ be the support of $G$, so that $\pi_{*}(G-S)=\Delta-\Delta' \geq 0.$ Let $A$ be sufficiently ample on $X$, so that $H=-C+\pi^{*}A$ is ample. Note that for small $s > 0$ we still have that $sS -C+\pi^{*}A=H_{s}$ is ample.
	
	Then $(Y, (1-rs)S+(1-t)D+rH_{s}+\pi_{*}^{-1}\Delta_{<1})$ is rlt for small $r,s,t > 0$ by \autoref{bertini}. We may choose $t$ sufficiently small that $a(E,X,\Delta) > t-1$ for each $E$ in the support of $D$. Write $\pi^{*}(K_{X}+\Delta)=K_{Y}+B$, and then choose $N$ as follows.
	\begin{align*}
	-N&=K_{Y}+S+(1-t)D+\pi_{*}^{-1}\Delta_{<1}+rH-\pi^{*}(K_{X}+\Delta+A)\\
	&=S+(1-t)D+\pi_{*}^{-1}\Delta_{<1}-rC-B
	\end{align*}
	From the choice of $t$, we have that for each $E$ in the support of $D$ that $\text{Coeff}_{E}(N)=(t-1)+a(E,X,\Delta) < 0$.
	
	Let $f\colon Y' \to X$ be the output of an MMP for $(Y, (1-rs)S+(1-t)F+rH_{s}+\pi_{*}^{-1}\Delta_{<1})$. By construction $Y'$ is $\mathbb{Q}$-factorial and is also a minimal model for the pair $(Y,S+(1-t)F+\pi_{*}^{-1}\Delta_{<1}+rH)$. In particular, letting $S',F',H', H'_{s},D'$ be the strict transforms of the corresponding divisors on $Y$, we have that $(Y',S'+(1-t)D'+f_{*}^{-1}\Delta_{<1})$ is dlt and $M=K_{Y}+S'+(1-t)D'+f_{*}^{-1}\Delta_{<1}+rH'$ is nef over $X$.
	
	Note then that $N'=f^{*}(K_{X}+\Delta+A)-M$, so that $-N'$ is nef over $X$. On the other hand $f_{*}N \geq 0$ and hence by negativity $N' \geq 0$. 
	
 	Every component of $D'$ has negative coefficient inside $N'$ by construction. Thus in fact $D'=0$, since $N' \geq 0$, and in particular every exceptional divisor on $Y$ over $X$ has discrepancy at most $-1$. Hence we have contracted every $E$ exceptional with $a(E,X,\Delta) >-1$ and therefore $S'=\text{Exc}(\pi)$. Moreover the pair $(Y,\Delta_{Y}=S'+f_{*}^{-1}\Delta_{<1})$ is dlt by construction. 
 	
 	Consider then $$F=f^{*}(K_{X}+\Delta)-(K_{Y}+\Delta_{Y})=B'-S'-f_{*}^{-1}\Delta_{<1}=N'-rC' \geq 0.$$ If $E$ is exceptional over $X$ then we have $\text{Coeff}_{E}F=\text{Coeff}_{E}(B'-S)=-(a(E,X,\Delta)+1)$. Suppose then $E$ is not exceptional. Then we get $\text{Coeff}_{E}F=\text{Coeff}_{E}(B'-f_{*}^{-1}\Delta_{\leq1})=\text{Coeff}_{f_{*}E}(\Delta-\Delta')$. If $\text{Coeff}_{f_{*}E}\Delta \geq 1$ then this yields $-(a(E,X,\Delta)+1)$, otherwise we get $\text{Coeff}_{E}F=0$.

 	
% 	By construction $(Y',\Delta_{Y'}+F)$ is dlt away from $F$, so $F$ is precisely the nlc locus of the pair and hence $\text{Supp}(F)=f^{-1}\text{Nlc}(X,\Delta)$. Similarly the nklt locus of $(Y,\Delta_{Y'})$ is $\lfloor \Delta_{Y} \rfloor=f^{-1}\text{Nklt}(X,\Delta)$. 
%
% 	Suppose that $(X,\Delta)$ is dlt. Then there is $Z$ on $X$ with such that $(X,\Delta)$ is log smooth away from $Z$ and every exceptional divisor centred on $Z$ has $a(E,X,\Delta) > -1$. Suppose that $E$ We must have $a(E,X,\Delta)=-1$ as $F=0$, and so $E$ is centred on $X \setminus Z$. Localising on the generic point of it's image, we may suppose that $(X,\Delta)$ is log smooth. 
% 	
% 	Conversely if the dlt modification extracts no divisors then we must have that $F=0$ and then $f^{*}(K_{X}+\Delta)=K_{Y}+\Delta_{Y}$, ensuring that $(X,\Delta)$ is dlt.
	
	If $X$ is plt, then $\lfloor\Delta_{Y}\rfloor=F=0$ and there are no exceptional divisors.
\end{proof}

%\begin{remark}
%	Strictly speaking, the assumption that the MMP holds for klt pairs in dimension $\leq n$ includes termination in dimension $\leq n-1$. Thus special termination holds by \cite{fujino2007special} \cite[Theorem 9.7]{bhatt2020}, and if we can run a klt MMP we can run a dlt MMP. Nonetheless the above proof without running a dlt MMP holds is included as it holds in a more general context where we can run terminating MMMP's, but not necessarily every MMP is know to terminate.
%	\end{remark}

\begin{remark}\label{lc-connect}
	Note that in the construction above we can choose $r$ sufficiently small that $\coeff_{E}(F) > 0$ ensures that $\coeff_{E}(N') > 0$ also. So we may assume $N'$ and $F$ have the same support. In particular if $C$ is a curve on $Y$ contracted over $X$ if it meets $F$ it must be contained in it. Otherwise $N'.C >0$, contradicting nefness of $-N'$.
	
	The main consequence of this is that if $F$ dominates $x \in X$ then it contains the fibre over $x$ also.
	\end{remark}

The case that $(X,\Delta)$ is klt is particularly important and is called a (small) $\mathbb{Q}$-factorialisation. One would like to be able to say that the dlt modification is small if $(X,\Delta)$ is dlt. This requires quite strong resolution of singularity assumptions, however. If $(X,\Delta)$ is dlt and admits a log resolution which is an isomorphism overt the snc locus, then it admits a small $\mathbb{Q}$-factorialisation.

A useful application of DLT modifications is the study of the non-klt and non-lc loci. In particular we have following generalisation of the Cone Theorem as well as a connectedness result for suitable pairs.


	\begin{theorem}[Nlc Cone Theorem]\label{NLCT}
	Let $(X,B)/T$ be an $R$-pair. Then write $\overline{NE}(X/T)_{nlc}$ for the cone spanned by curves contained in the non log canonical locus of $X$. Then we have the following decomposition
	
		\begin{enumerate}
		\item $$\overline{NE}(X/T)=\overline{NE}(X/T)_{K_{Y}+\Delta \geq 0} +\overline{NE}(X/T)_{nlc}+ \sum_{i} \mathbb{R}_{>0}[C_{i}]$$
		\item The rays $C_{i}$ do not accumulate in $(K_{Y}+\Delta)_{<0}$.
		\item For each $i$ there is $d_{C_{i}}$ with 
		\[0 < -(K_{X}+\Delta).C_{i} \leq 2nd_{c_{i}}\]
		and $d_{C_{i}}$ divides $L\cdot_{k}C_{i}$ for every Cartier divisor $L$ on $X$.
		\item For each $C_{i}$ we have $\mathbb{R}_{>0}[C_{i}] \cap \overline{NE}(X/T)_{nlc} = {0}$.
	\end{enumerate}
\end{theorem}
\begin{proof}
	If $(X,B)$ is dlt then it is the limit of klt pairs $(X,\frac{n}{n+1}B)$ and the Cone Theorem follows immediately from the klt case.
	
%	Suppose next that $\Delta=B+F$ where $(X,B)$ is dlt and $F$ has the same support as $\lfloor B \rfloor$. Note that if $C$ is an irreducible curve with $F.C <0$ then $C \subseteq F$. Therefore any effective curve $C$ can be written $C=C_{\geq 0} +C_{F}+C_{<0}$ where $F.C_{\geq 0},(K_{X}+B).C_{\geq 0} \geq 0$, $C_{F} \subseteq F$ and $(K_{X}+B).C_{< 0} <0$. Thus by compactness of the unit ball, any $\gamma \in \overline{NE}(X/T)$ can be written $\gamma = \gamma_{\geq} +\gamma_{F}+\gamma_{<0}$ in the same fashion.
%	
	Suppose next that $\Delta=B+F$ where $(X,B)$ is dlt and $F$ has the same support as $\lfloor B \rfloor$. Note that if $C$ is an irreducible curve with $F.C <0$ then $C \subseteq F$. Therefore any effective curve $C$ can be written $C=C_{0} +C_{F}$ where $F.C_{0}\geq 0$ and $C_{F} \subseteq F$. Thus by compactness of the unit ball, any $[\gamma] \in \overline{NE}(X/T)$ can be written $[\gamma] = [\gamma_{0}] + [\gamma_{F}]$ with $F.\gamma_{0} >0$ and $[\gamma_{F}] \in \overline{NE}(F/T)$ in the same fashion.
	
	Take any $K_{X}+\Delta$ negative extremal ray $L$. Take a non-zero $[\gamma] \in L$, then as $L$ is extremal we have $[\gamma_{F}],[\gamma_{0}] \in L$. If $[\gamma_{F}] \neq 0$ then $L \subseteq \overline{NE}(F/T)$. Otherwise if $[\gamma_{F}]=0$ then $L$ is $K_{X}+B$ negative. Hence we can conclude the result from the Cone Theorem for dlt pairs.
	
%		Hence if $C$ is an effective curve, we can write $C=C'+C_{F}$ where $C_{F} \in \overline{NE}(F/T)$ and $C_{0}.F \geq 0$. Then $C'= C_{0} + \sum_{1}^{n}C_{i}$ where $C_{i}$ are $K_{X}+B$ negative extremal rays. Reselecting $C_{F}$ and $C_{0}$ we may assume that $F.C_{i} > 0 $ and $C_{0}=\sum r_{j}$ for $r_{j}$ irreducible curves not contained in $F$ so that $(K_{X}+B+F).C_{0} \geq 0$. Similarly if $(K_{X}+B+F).C_{i} \geq 0$ we replace $C_{0}$ with $C_{0}+C_{i}$ and thus we can assume $(K_{X}+B+F).C_{i} < 0$ for each $i$. 
		
	Suppose finally that $X$ is not dlt. Let $\pi \colon Y \to X$ be a dlt modification of $(X,B)$ with $(Y,B_{Y})$ dlt and $K_{Y}+B_{Y}+F=\pi^{*}(K_{X}+B)$. Take any $K_{X}+B$ negative extremal ray, $L$, such that $L \cap\overline{NE(X)}_{nlc}=\{0\}$. Take any class $\gamma$ with $[\gamma] \in L\setminus \{0\}$ and choose $[\gamma'] \in \overline{NE}(Y/T)$ with $f_{*}[\gamma']=[\gamma]$. Then by the projection formula we have that $(K_{Y}+B_{Y}+F).\gamma'=(K_{X}+B).f_{*}\gamma'=(K_{X}+B).\gamma < 0$. 

	From above, we can write $\gamma'=C_{0}+C_{F}+ \sum \lambda_{i}C_{i}$ where $\lambda_{i} >0$, $(K_{Y}+B_{Y}+F).C_{0} \geq 0$ $C_{F} \in \overline{NE}(F/T)$ and the $C_{i}$ each generate $(K_{Y}+B_{Y}+F)$ negative extremal rays with $-(K_{Y}+B_{Y}+F).C_{i} \leq 2nd_{c_{i}}$. 	
%	We may further decompose $C$ as $C=\sum r_{j}$ where $(K_{Y}+B_{Y}).r_{j} \geq 0$ and each $r_{i}$ has irreducible support. Then for each $j$ either $(K_{Y}+B_{Y}+F).r_{j} \geq 0$ or $r_{j}$ is contained in the support of $F$. In either case $[f_{*}r_{j}]$ cannot be in $R$.
	From our choice of $R$ we must have $f_{*}C_{0}=f_{*}C_{F}=0$ and hence it follows that $[f_{*}C_{k}] \in R\setminus \{0\}$ for some $k$. Thus $(K_{X}+B).f_{*}C_{k}=(K_{Y}+B_{Y}+F).C_{k} \geq -2nd_{c_{i}}$.
	
	Since each $R$ is the pushforward of a $(K_{Y}+B_{Y})$ negative extremal ray, there are only countably many generating curves $C_{i}$ and they cannot accumulate in $(K_{X}+\Delta)_{< 0}$ else they would accumulate on $Y$ also.
\end{proof}


\begin{theorem}[Weak Connectedness Lemma]\label{WLC}
	Let $(X,\Delta)/T$ be an $R$-pair with $f_{*}\ox = \ox[T]$. Then if $-(K_{X}+\Delta)$ is big and nef. Suppose that $\textup{Nklt}(X,\Delta)$ is vertical over $T$ then for any $t \in T$, $f^{-1}t \cap \textup{Nklt}(X,\Delta)$ is connected. Otherwise $\textup{Nklt}(X,\Delta)$ dominates $T$ and it is connected. 
	
	In particular $\textup{Nklt}(X,\Delta)$ is always connected in a neighbourhood of any $t\in T$.
\end{theorem}

\begin{proof}
	
	If $(X,\Delta)$ is klt over $T$ then the result is trivial so assume otherwise.
	
	Writing $-K_{X}+\Delta=A+E$ for suitably small $E$ such that $\text{Nklt}(X,\Delta)=\text{Nklt}(X,\Delta+E)$, we may replace $\Delta$ with $\Delta+E$ and assume that $-(K_{X}+\Delta)$ is ample. 
		
	We prove this by induction. Suppose first that $(X,\Delta)$ has dimension $1$, then $R$ is a field. If $-(K_{X}+\Delta)$ is big and nef then so is $-K_{X}$. Then we have $\deg K_{X} = -2$ by \cite[Corollary 2.8]{tanaka2018minimal} giving that $ \deg \Delta <2$. The non-klt locus of $(X,\Delta)$ is precisely the support of $\lfloor \D \rfloor$ and hence can contain at most one point.
	
	Now suppose that the result holds when the total dimension of $X$ is less than $n$, take $X$ of dimension $n$.
	
	Let $f \colon (Y,\D_{Y}) \to (X,\D)$ be a dlt modification. Then $-L:=K_{Y}+\D_{Y}+F=f^{*}(K_{X}+\D)$ with $(Y,\D_{Y})$ dlt and $L$ nef and big. We may further write $L=A+E$ with $A$ ample and $E$ effective and exceptional over $X$. In particular $E$ has support contained inside $S_{Y}=\lfloor \D_{Y} \rfloor$. Note that $S_{Y}$ maps surjectively onto $\nklt(X,\D)$ so it is sufficient to show that $S_{Y}$ is connected.
	
	Take a general $G_{Y} \sim \epsilon A +(1-\epsilon) L-\delta S_{Y}$, then for small $\delta$ we may assume $G_{Y}$ is ample. It may not quite true that we can choose $G_{Y}$ such that $(X,\D_{Y}+G_{Y})$ is dlt. However $\D_{Y}+G_{Y}=\D_{Y}-\delta S_{Y} +\epsilon A + (1-\epsilon)L$ so the pair is rlt and we may still run a terminating $K_{Y}+\Delta_{Y}+G_{Y}$ MMP. Moreover the pair $(Y,\D_{Y}+G_{Y})$ generalised dlt, which is preserved by this MMP. In particular $(Y,\D_{Y})$ remains dlt during this MMP. By the same logic, if in fact $(Y,\D_{Y})$ is plt then it remains so throughout the MMP.
	
	Write $K_{Y}+\D_{Y}+G_{Y}\sim - P_{Y}=-(\epsilon E + F + \delta S_{Y})$ and note $\text{Supp}(P_{Y})=S_{Y}$. In particular $K_{Y}+\D_{Y}+G_{Y}$ is not pseudo-effective. Let $Y \dashrightarrow Y'$ be a $(Y,\D_{Y}+G_{Y})$ LMMP. If $\dim T < \dim X$ then this terminates in a Mori fibre space $Y' \to Z$. Otherwise we have that $Y'$ such that $-P_{Y}\simeq K_{Y}+\D_{Y}+G_{Y}$ is nef over T. These two possibilities correspond to the verticality conditions. If $\textup{Nklt}(X,\Delta)$ dominates $T$, so does $P_{Y}$ and we must end with a Mori Fibration. Otherwise $\textup{Nklt}(X,\Delta)$ is vertical over $T$, then $-P_{Y}$ is psuedo-effective and we end with $-P_{Y'}$ nef.
	
	We claim that on the induced pair $(Y',\D_{Y'})$, $\nklt(Y',\D_{Y'})=\text{Supp}(\lfloor \D_{Y'} \rfloor)=\text{Supp}(P_{Y'})$ has the same number of connected components as $\nklt(X,\Delta)$. Indeed $P_{Y}$ has the same number of components, so suppose for contradiction there is an MMP step which reduced the number of connected components. Replacing $Y$ with the first point of failure, we can assume there is a step $\pi: Y \dashrightarrow \hat{Y}$ such that $P_{\hat{Y}}$ has one fewer connected components. 
	
	Since $\text{Supp}(P_{Y})=\lfloor \D_{Y} \rfloor$, we can subtract components of $P_{Y}$ from $\Delta$ and assume that $\lfloor \D_{Y} \rfloor$ contains only two components $S_{1}, S_{2}$ which are disjoint on $Y$ but whose strict transforms meet on $\hat{Y}$. However $(Y,\Delta_{Y})$ is then $\mathbb{Q}$-factorial plt, and thus so too must $(\hat{Y},\D_{\hat{Y}})$ be. In particular $\lfloor \D_{\hat{Y}} \rfloor$ consists of disconnected divisors, a contradiction. 
	
	The only possibility then is that $\pi: Y \to \hat{Y}$ is divisorial and contracts a connected component of $P_{Y}$. Let $P_{Y}=\sum P_{Y}^{i}$ be the decomposition into connected components. Then we can assume $P_{Y}^{1}$ is the contracted component, in which case it is a prime divisor. Thus $P_{Y}^{1}.C <0$ for any contracted curve, since $\hat{Y}$ is $\mathbb{Q}$-factorial. On the other hand $P_{Y}^{j}.C=0$ for any such $C$, since $P_{Y}^{j}$ does not meet $P_{Y}^{1}$. Thus $P_{Y}.C <0$. This is a $-P_{Y}$ MMP however, so this cannot be the case. Hence, as claimed, the number of connected components of $P_{Y'}$ is the same as $P_{Y}$.
	
	Suppose first that $-P_{Y'} \simeq K_{Y'}+\D_{Y'}+G_{Y'}$ is nef over $T$. Then $P_{Y'} \geq 0$ has $-P_{Y}$ nef over $T$. Thus for any $t \in T$, if $P_{Y'}$ meets the fibre over $t$ it must contain the entire fibre. Otherwise there would be some curve $C$ mapped to $t$ and meeting $P_{Y}$ but not contained in it, contradicting nefness of $-P_{Y}$.
	
	Otherwise we assume that $Y' \to Z$ is a Mori Fibration. Suppose then that $\dim Z=0$. Then $Y'$ is a variety over a field with $\rho(Y')=1$. In particular if $D,D'$ are effective and $H$ ample, then $H^{n-2}.D.D' >0$, so certainly $D\cap D' \neq \emptyset$. Thus $P_{Y'}$ cannot have disconnected support.
	
	Otherwise have that $\dim Z > 0 $. Let $F$ be the generic fibre. We must have $P_{Y'}|_{F}> 0$ since $Y' \to Z$ is a $P_{Y'}\sim -(K_{Y'}+\Delta_{Y'}+G_{Y'})$ positive contraction. However $P_{Y'}$ has the same support as $\lfloor \D_{Y'} \rfloor$ so at least one connected component must dominate $Z$. Suppose then, for contradiction, there is a second connected component. We claim it must also dominate $Z$. Indeed let $S_{1},S_{2}$ be the two connected components and assume that $S_{1}$ dominates $Z$. Then $S_{1}.C > 0$ for any contracted curve $C$. If we choose $C$ contained entirely in $S_{2}$ we see that it meets $S_{1}$, so no such curve exists and $S_{2}$ is not vertical.

	Consider then $(F,\D_{F}=\D_{Y'}|_{F})$. Since $F \to Y'$ is flat, the pullback of $\D_{Y'}$ is just the inverse image, and in particular $\lfloor \D_{T} \rfloor$ contains the pullback of both connected components. Suppose $L$ is the extremal ray whose contraction induces the Mori fibration. Then we have $-(K_{Y'}+\D_{Y'}+G_{Y'}).L >0$, but since $L$ is spanned by a nef curve, as contracting it defines a fibration, and $G_{Y'}$ is effective, we must have $G_{Y'}.L \geq 0$. Hence in fact $-(K_{Y'}+\D_{Y'}).L >0$ also, and so $-K_{F}+\D_{F}$ is ample. Then, however, the non-klt locus of $(L,\D_{L})$ must be connected by induction, a contradiction.

\end{proof}


In practice we have essentially run a $K_{Y}+B_{Y}-\delta S_{Y}+ M$ MMP for $M=-f^{*}(K_{X}+B)$ big and nef which preserves dltness of $K_{Y}+B_{Y}$. Working with generalised pairs instead, one can push this result quite far for pairs with rational coefficients. Thinking of $(Y,B_{Y}+M)$ as a generalised dlt pair and instead running a $K_{Y}+B_{Y}+M\simeq_{T} -F$ MMP we obtain the same result for the nlc locus. This proof works even if $M$ is only nef, however termination in this case requires special termination for dlt pairs. This then generalises \autoref{lc-connect}.  Many of these ideas are explored for positive characteristic pairs in \cite{filipazzi2020connectedness}.

%Finally if $\dim T  \neq 0$ and $\nklt(X,\Delta)$ is vertical, we can take $D \geq 0$ Cartier on $T$ containing it's image. If $g^{*}D$ is the pullback then $\nklt(X,\Delta)=\textup{Nlc}(X,\Delta+\epsilon g^{*}D)$ for small $\epsilon >0$ and $-(K_{X}+\Delta+\epsilon g^{*}D)$ is still nef over $T$. In this case then the $\nklt$ case reduces to the $\textup{Nlc}$ case.


\myworries{Put in generalised pairs, somewhere for dlt preserving reasons}

\subsection{Adjunction}

\myworries{Put in adjunction section}

Dlt modifications are also closely related to the study of adjunction. We work under the same assumptions as \autoref{subsec-mod}, however the main focus is on the setting of \autoref{MMP}. 
In particular we have the following easy application.

\begin{theorem}\label{t-inv_adj}
	Let $(X,S+B)$ be a log-pair where $S$ is a prime divisor not contained in the support of $B \geq 0$. If $(X,S+B)$ is plt near $S$ if and only if $(S^{N},B_{S^{N}})$ is klt, where $S^{N} \to S$ is the normalisation of $S$ and $B_{S^{N}}$ is the different \cite[Definition 4.2]{kk-singbook}. Similarly $(X,S+B)$ is lc near $S$ if and only if $(S^{N},B_{S^{N}})$ is lc.
\end{theorem}

\begin{proof}
	The question is local on $X$ so we may assume it is affine with $X=\text{Spec}(R)$, and hence that $X$ is an $R$-pair. Now, one direction is \cite[Lemma 4.8]{kk-singbook}, so suppose that $(S^{N},B_{S^{N}})$ is klt. Let $\pi\colon Y \to X$ be a dlt modification, so that $\pi^{*}(K_{X}+S+B)=K_{Y}+S_{Y}+B_{Y}+F$. Suppose that $E$ is a a divisor exceptional over $X$ with $a(E,X,S+B) \geq 1$. Let $T$ be the normalisation of $S_{Y}$. Now we have that the induced pair $(T,B_{T})\to (S^{N},B_{S^{N}})$ is crepant. Since $(T,B_{T})$ is sub-klt it cannot be that $S_{Y}$ meets $E$ by \cite[Claim 4.7.3]{kk-singbook}. On the other hand, the non-klt locus of $(Y,S_{Y}+B_{Y})$ is connected in a neighbourhood of the fibre over any point by \autoref{WLC}. Hence $\pi(E)$ does not meet $S$.
	
	The lc case is identical, using \autoref{lc-connect} in place of \autoref{WLC} to see that if $\pi(F)$ meets $S$ then $F$ meets $S_{Y}$. 
\end{proof}

\begin{remark}\label{no-res}
	
	If it is known that one can run an lc MMP, then a similar argument can be made for the lc case that does not use log resolutions. Assume for contradiction that $(X,S+B)$ is not lc. Then there is $Y \to X$ extracting $E$ lying over $s \in S$ with $a(E,X,S+B)> 1$. Let $F$ be the reduced exceptional divisor and run a $K_{Y}+\pi_{*}^{-1}(S+B)+F$ MMP. This does not contract $E$ because the discriminant at $E$ cannot increase, so we can replace $Y$ with the output and assume that $K_{Y}+\pi_{*}^{-1}(B+S)+F+G=\pi^{*}(K_{X}+B+S)$ for $G\geq0$ exceptional with $-G$ nef over $X$. By assumption $\text{Supp}(E) \subseteq \text{Supp}(G)$. Then as $G$ is nef it contains the fibre over $s$, and hence meets $\pi_{*}^{-1}S$, contradicting \cite[Claim 4.7.3]{kk-singbook}.
	
	The plt/klt case is slightly more involved, but can also be proven with a modification of the arguments of $\autoref{WLC}$ so long as we can run suitable klt MMPs. We may assume as above there is $\pi \colon Y \to X$ extracting $E$ with $a(E,X,B+S)=1$ lying over $s \in S$ such that $K_{Y}+\pi_{*}^{-1}(B+S)+F$ is nef over $Y$. Then we can run a $-(F+\pi_{*}^{-1}S)$ MMP by perturbing $K_{Y}+\pi_{*}^{-1}(B+S)$ as in \autoref{WLC}. Thus we may assume that $-(F+\pi_{*}^{-1}S)$ is nef. This yields a contradiction, however, as then $F+\pi_{*}^{-1}S$ contains the fibre over $s$, and some component of $F$ meets $S$.
	\end{remark}

In practice we often wish to know more than this, that if $(X,S+B)$ is plt then in fact $(S,B_{S})$ is klt. From above it is enough to know that $S$ is normal. While normality of plt centres is in general an open problem, it is known that the result holds up to universal homeomorphism for prime $Q$-Cartier centres.

\begin{lemma}\cite[Lemma 2.1]{hacon2020relative}\label{plt-universal}
	
	Let $(X,D+B)$ be a plt log-pair with $D$ prime and $\mathbb{Q}$-Cartier. Then the normalisation $D^{N} \to D$ is a universal homeomorphism.
	
	\end{lemma}

More is understood in the case $X$ has dimension $3$,

\begin{theorem}\cite[Corollary 7.17]{bhatt2020}\label{plt-adj}
		Let $(X,S+\Delta)$ be a plt log-pair. Suppose that $\Delta$ has standard coefficients all less than $1$. Take any $x \in S$ with $\textup{char } k(x) > 5$ $S$ is normal at $x$. In particular the same holds if $K_{X}+S$ is $\mathbb{Q}$-Cartier.
\end{theorem}

When $S$ is the special fibre of $X$ over a DVR yet more can be said. In this case normality is closely related to Cohen-Macaulay-ness and rationality of klt singularities over the residue field. The important characterisation to keep in mind is the following.

\begin{theorem}\cite[Theorem 1.16]{kovacs2017rational}
	Let $X$ be a scheme admitting a dlt pair $(X,\Delta)$, then $X$ has rational singularities if and only if $X$ is Cohen-Macaulay.
\end{theorem}

The first result, due to \cite{hacon2020relative}, lets us extend the previous theorem. Roughly speaking it says that if $X \to R$ is a fibration such that $(X,X_{k})$ is plt and the normalisation of $X_{k}$ is Cohen-Macaulay then $X_{k}$ is normal. In particular this holds if klt singularities are Cohen-Macaulay over $k$, in dimension $\dim X_{k}$.

The key observation we will use is the following.

\begin{lemma} \label{lift-lemma-1}
	
	Let $R$ be a complete, excellent DVR and suppose $\mathcal{X} \to R$ is an integral, normal $R$ scheme. Let $X$ be the special fibre, and $X^{N} \to X$ be the normalisation map. If $X^{N}$ admits a formal lift over $R$ then $X^{N} \to X$ is an isomorphism.
	
	\end{lemma}

\begin{proof}
	The morphism $X^{N} \to X$ is necessarily finite. Thus by \cite[Tag 09ZT]{stacks-project} there is an algebraic lift $\bar{\mathcal{X}}$ of $X^{N}$, endowed with a corresponding finite morphism $\bar{\mathcal{X}} \to \mathcal{X}$. On the other hand $\bar{X} \to \mathcal{X}$ is an isomorphism over the generic point of $X$ inside $\mathcal{X}$, and hence a birational morphism. Since $X$ is normal, $\bar{\mathcal{X}}\to \mathcal{X}$ must be an isomorphism. In particular, so too is $X^{N} \to X$.
\end{proof}

The normality of a special fibre, therefore, is equivalent to liftability of the normalisation. We then have the following liftability characterisation.

\begin{lemma}\cite[Lemma A.23]{zdanowicz2018liftability}\label{lift-lemma-2}
	
	Let $U \to X$ be an open immersion of $k$-schemes. Let $Z=X \setminus U$ and suppose that $Z$ has codimension at least $3$ in $X$. Then if $X$ is $S_{3}$ at every point of $Z$, the morphism of deformation functors $\text{Def}_{X} \to \text{Def}_{U}$ is smooth, and in particular $\text{Def}_{X}(A) \to \text{Def}_{U}(A)$ is surjective for any local, Artinian ring $A$.  
	
	\end{lemma}

\begin{lemma}\label{adj1}
	
	Let $R$ be a complete DVR with residue field of characteristic $p > 5$ and suppose $\mathcal{X} \to R$ is an integral, normal $R$ scheme. Let $X$ be the special fibre, and $X^{N} \to X$ be the normalisation map. If $(\mathcal{X},X)$ is a plt $R$-pair, and $X^{N}$ is Cohen-Macaulay, or even just $S_{3}$, then $X$ is normal.
	
\end{lemma}

\begin{proof}

	Then by \autoref{lift-lemma-1} it suffices to check that $X^{N}$ admits a formal lift. By \autoref{lift-lemma-2}, since $X^{N}$ is $S_{3}$, we need only check this away from a closed subset of codimension at least $3$. By localising at codimension $2$ points of $X$ and applying \autoref{t-inv_adj}, however, we see that $X$ is normal in codimension $2$. Therefore $X^{N} \to X$ is an isomorphism away from a closed subset of codimension $3$ and the result follows, since $X$ lifts.
	
\end{proof}

Note that $X^{N}$ is always klt under these assumptions. This result does not use the results of the MMP, however if $R$ is not complete then the existence of log resolutions is needed to ensure that the plt condition is preserved by base change to the completion. Alternatively if plt inversion of adjunction is known, then base change to the completion preserves pltness - since the fibre is not changed. 
%In particular, as noted in \autoref{no-res} the existence of certain klt MMPs is enough to ensure that inversion of adjunction holds.

While this is a very useful characterisation, it cannot be applied to the case that $(X,X_{k}+B)$ is a plt pair over a DVR with $X$ not $\mathbb{Q}$-Gorenstein unless $B$ has standard coefficients. However we also have a very similar set of results coming from vanishing of certain cohomology classes. For this we need the following liftability result.

\begin{proposition}\label{push-lift}
	Let $S$ be a local Artinian ring and $T \hookrightarrow S$ be a closed immersion defined by a square-zero ideal $I$.  Let $f\colon Y \to T$, and $h\colon X \to T$ be flat morphisms and let $g\colon Y \to X$ be a morphism of $T$-schemes. 
	Suppose that $g_{*} \ox[Y]=\ox$, $R^{1}g_{*} \ox[Y] = 0$ and $Y$ has a flat lifting $f' \colon Y' \to S$. Then there exists a flat lifting $X'$ over $S$ and a morphism $g' \colon Y' \to X'$ making the following commutative diagram:
	
	\[\begin{tikzcd}
	Y \arrow[r] \arrow[d, "g"]  \arrow[bend right=60,swap, "f"]{dd}
	& Y' \arrow[d, "g'"] \arrow[bend left=60,swap, "f'"]{dd} \\
	X \arrow[d, "h"] \arrow[r] & X' \arrow[d, "h'"] \\
	T \arrow[r]                        & S    .                     
	\end{tikzcd}\]	
	Moreover,  $g'_{*} \ox[Y']=\ox[X']$ and $R^{1}g'_{*} \ox[Y'] = 0$.
\end{proposition}

\begin{proof}
	This is essentially the construction of \cite[Theorem 3.1]{cynk2009small}.
	
	As $Y'$ has the same underlying topological space of $Y$, we may see the sheaf $\mathcal{O}_{Y'}$ as a sheaf on the topological space $Y$. 	
	Now we define $X'$ to coincide with $X$ as a topological space and the natural map $g'$ coinciding with $g$. The schematic structure on $X'$ is given by the sheaf $g_*\mathcal{O}_{Y'}$. 
	This construction fits naturally in a commutative diagram as above and we are only left to check that $X'$ is a flat lifting of $X$ over $S$.
	
	Since this can be checked locally, we may assume that $X, X'$ are affine.
	The defining short exact sequence of the extension is
	\[\mathcal{E} \colon 0 \to I \to S \to T \to 0 \]
	Since $\mathcal{O}_{Y'}$ is flat over $S$, this induces a corresponding short exact sequence of $\ox[Y']$ modules on $Y'$.
	\[ \mathbf{L}f'^{*}\mathcal{E} \colon 0 \to f'^{*}I \to \ox[Y'] \to \ox[Y] \to 0 \]
	
	We now push this forward by $g'$ onto $X'$. Since the pushforward is a topological in nature we have $\mathbf{R}g'_{*}\ox[Y]=\mathbf{R}g_{*}\ox[Y]$. Similarly since $I$ has the natural structure of an $R$ module, induced by $I^{2}=0$, we have an identification $f^{*}I=f'^{*}I$ as group sheaves.
	Thus we obtain the following.
	\[0 \to h^{*}I \to g'_{*}\ox[Y'] \to \ox[X] \to \mathbf{R}^{1}g_{*}\ox[Y] \otimes h^{*}I \to \mathbf{R}^{1}g'_{*}\ox[Y'] \to \mathbf{R}^{1}g_{*}\ox[Y] \to \] 
	By assumption $\mathbf{R}^{1}g_{*}\ox[Y]=0$ and so we have
	\[\mathbf{R}g'_{*}\mathbf{L}f'^{*}\mathcal{E}\colon 0 \to h'^{*}I \to \ox[X'] \to \ox[X] \to 0\]
	viewed here as a sequence of $\ox[X']$ modules.
	
	Moreover we have $\mathbf{R}g'_{*}\mathbf{L}f'^{*}\mathcal{E}=\mathbf{L}h'^{*}\mathcal{E}$, and thus we see that there is a canonical identification $\ox[X']\otimes R= \ox[X]$. That is $X' \times_{S} T= X$. We also see that $\textup{Tor}^{i}(\ox[X'], R)=0$, since $\mathbf{L}h'^{*}\mathcal{E}$ is nothing but $\ox[X'] \otimes^{L} \mathcal{E}$. Since $\ox= \ox[X']/ I \ox[X']$ is flat over $R$, by assumption, we must have by \cite[\href{https://stacks.math.columbia.edu/tag/0AS8}{Tag 0AS8}]{stacks-project} that $\ox[X']$ is a flat $S$ module, as required.
	
\end{proof}

\begin{theorem}\label{adj-push}
	Let $R$ be a DVR and let $X$ be a normal projective $R$-scheme such that $X_{k}$ is normal. 
	Let $f \colon X \to Z$ be a contraction over $R$ and suppose that $$f_{k}\colon X_{k} \xrightarrow{g_{1}} Y_{1} \xrightarrow{h_{1}} Z_{k}$$ is the Stein factorisation of $f_{k}$. If $R^{1}g_{1,*} \ox[X_{k}]=0$, then $Z_k$ is normal and $h_{1}$ is an isomorphism. In particular $f_{k,*}\ox[X_{k}]=g_{1,*}\ox[X_{k}]=\ox[Z_{k}].$
\end{theorem}

\begin{proof}
	Since we are only interested in the special fibre, we can replace $R$ with its completion at its maximal ideal $\mathfrak{m}$ without any loss of generality.
	Write $R_{i}=R/\mathfrak{m}^{i}$ where $m$ is the maximal ideal of $R$, then let $X_{i}=X \times R_{i}$, $Z_{i}=Z\times R_{i}$ and $f_{i}=f\times R_{i}\colon X_{i} \to Z_{i}$.
	Then $f_{1}$ factors as $f_{1}\colon X_{1} \xrightarrow{g_{1}} Y_{1} \xrightarrow{h_{1}} Z_{1}$ where $R^{i}g_{1,*}\ox[X_{1}]=0$, so by \autoref{push-lift} we can lift $g_{1}\colon X_{1} \to Y_{1}$ to $g_{i}\colon X_{i} \to Y_{i}$ over $R_{i}$ such that the following diagram commutes.
	
	\[\begin{tikzcd}
	X_{1} \arrow[r] \arrow[d, "g_{1}"] & X_{2} \arrow[r] \arrow[d, "g_{2}"] & ... \\
	Y_{1} \arrow[r] \arrow[d, "h_{1}"] & Y_{2} \arrow[d, dotted, "h_{2}"] \arrow[r]  & ... \\
	Z_{1} \arrow[r]                    & Z_{2} \arrow[r]                    & ...
	\end{tikzcd}\]
	Here the $h_{i}$ are defined as follows. The underlying topological map is just $h_{1}$ and the map $\ox[Z_{i}] \to h_{i,*}\ox[Y_{i}]$ comes from the map ${\ox[Z_{i}] \to f_{i,*}\ox[X_{i}]}$ and the identification $f_{i,*}\ox[X_{i}]=h_{i,*}g_{i,*}\ox[X_{i}]\simeq h_{i,*}\ox[Y_{i}]$.
	Each $h_{i}$ is finite, and thus by
	\cite[\href{https://stacks.math.columbia.edu/tag/09ZT}{Tag 09ZT}]{stacks-project} we have that the compatible system $\left\{Y_{i} \to Z_i \right\}$ lifts to a finite morphism $Y \to Z$ over $R$. By \cite[\href{https://stacks.math.columbia.edu/tag/0A42}{Tag 0A42}]{stacks-project} there is a factorisation ${f\colon X \xrightarrow{g} Y \xrightarrow{h} Z}$, where $g_{*}\ox = \cO_Y$, because $g_{i,*}\cO_{X_i}=\cO_{Y_i}$ for all $i$. Similarly $h$ is a finite morphism. 
	
	Therefore $f \colon X \xrightarrow{g} Y \xrightarrow{h} Z$ is the Stein factorisation for $f$, but since $f$ is a contraction of normal schemes we conclude that $h$ has to be an isomorphism.
	In particular, $h_1$ is an isomorphism and $Z_{k}=Y_{k}$, thus concluding.
	%By construction the special fibre $Y_k$ of $Y$ is normal, and thus so is $Y$. Hence as $X \to Y$ contracts all the same curves as $X \to Z$ we must have that $h$ defines an isomorphism $Y \simeq Z$.
	%	\textcolor{red}{Could we also argue as follows:   - Yes, I think of this as being the case because they're both contractions which contract the same curves, but I can rephrase this if you'd like}
\end{proof}

\begin{remark}
	The key observation in previous proof is that we can think of $Y_{i}$ as the lift of $Y_{1}$ over $Z_{i}$ rather than simply over $R_{i}$. This construction can be thought of as a generalisation of \autoref{push-lift}.
\end{remark}

Although Kawamata-Viehweg Vanishing fails in positive characteristic, we often have sufficiently strong vanishing type results in low dimensions.

\begin{lemma}\label{invAdj2}
	Let $R$ be an excellent DVR.
	Let $(X,X_{K}+\Delta)$ be a plt $R$-pair. Suppose that
	\begin{enumerate}
		\item $X_k$ is normal;
		\item $\dim Z_{k} \geq 1$;
		\item there is a contraction $f \colon X \to Z$ over $R$ such that $-(K_{X_{k}}+\Delta_{k})$ is $f_{k}$-big and $f_k$-nef;
		\item $X$ has dimension at most $3$, or $k$ is perfect of characteristic $p\geq 7$ and $X$ has dimension at most $4$.
	\end{enumerate}  
	Then $Z_{k}$ is normal and $f_{k,*}\ox[X_{k}]=\ox[Z_{k}]$. Further, if $f$ is birational and $B:=f_{*}\Delta$, then $(Z, Z_k+B)$ is plt and $(Z_{k},B_{k})$ is klt.
\end{lemma}

\begin{proof}
	Since $X_{k}$ is normal, the pair $(X_{k},\Delta_{k})$ is klt by adjunction. Then we can replace $R$ with its completion to prove the first claim, as this leaves the special fibre unchanged.	
	Let $$f_{k}\colon X_{k} \xrightarrow{\bar{f}_{k}} \bar{Z_k} \xrightarrow{h_k} Z_{k}$$ be the Stein factorisation. We can assume $\dim Z_{k} > 0$ else there is nothing to prove.
	Since $-(K_{X_{k}}+\Delta_{k})$ is $\bar{f}_{k}$-big and $\bar{f}_{k}$-nef, we conclude $R^{i}\bar{f}_{k,*}\ox[X_{k}]=0$ for $i> 0$ by \cite[Theorem 3.3]{tanaka2018minimal} if $\dim X =3$ and \cite[Theorem 25]{bernasconi2020vanishing} otherwise.
	By \autoref{adj-push} $h_k$ is an isomorphism, $f_{k,*}\ox[X_{k}]=\ox[Z_{k}]$ and $Z_{k}$ is normal.
	
	Suppose now $f$ is birational. As $(X,\Delta+X_k)$ is plt, so is $(Z,B+Z_k)$ as the plt centre $X_k$ is not contracted. Hence $(Z_k,B_k)$ is klt by adjunction.			
\end{proof}

\begin{remark}
	If $\dim(Z_k)=0$ and $\dim X \leq 3$, then $H^1(X_k, \mathcal{O}_{X_k})=0$ if $k$ is perfect (\cite[Proposition 2.20]{NT20}) or $p \geq 7$ (\cite[Theorem 5.7]{BT22}). Under these assumptions, the proof of \autoref{invAdj2} still holds, though it is typically less interesting in this setting.
\end{remark}

We are now able to prove the normality of a special fibre in a plt family, not necessarily $\mathbb{Q}$-Gorenstein, assuming that klt pairs have rational singularities over the residue field and the base is complete.

\begin{theorem}\label{NormalToRational}
	Let $R$ be a complete, excellent DVR with residue field, $k$, of characteristic $p> 5$. Suppose that every klt pair of dimension $\dim X_{k}$ has rational singularities. If $(X,\Delta+X_{k})$ is a plt $R$-pair then $X_{k}$ is normal and $(X_{k}, \Delta_{k})$ is a klt pair.
\end{theorem}

\begin{proof}
	
	Let $f\colon (Y,\Delta_{Y})\to (X,\Delta)$ be a small $\mathbb{Q}$-factorialisation. Then $(Y,\Delta_{Y}+Y_{k})$ is a $\mathbb{Q}$-factorial plt pair and hence $Y_{k}$ is normal by \autoref{adj1}, since $Y_{k}^{N}$ has klt, and hence Cohen-Macaulay, singularities by assumption. In particular $Y_{k}=Y^{N}$. Then since $X_{k}^{N}$ is also klt, it has rational singularities and so by \autoref{adj-push}, $X$ is normal also and hence $(X_{k},\Delta_{k})$ is a klt pair.
	
\end{proof}

In particular the result holds when $X$ has dimension $3$, even if $R$ is not complete, without any further assumptions besides those on the characteristic.
 
\begin{corollary}\label{invAdj3}
	Let $R$ be an excellent DVR with residue field, $k$, of characteristic $p> 5$. Suppose $(X,\Delta+X_{k})$ is a plt $R$-pair and that $X$ has dimension $3$. Then $X_{k}$ is normal and $(X_{k}, \Delta_{k})$ is klt.
\end{corollary}

\begin{proof}
	Let $f\colon (Y,\Delta_{Y})\to (X,\Delta)$ be a small $\mathbb{Q}$-factorialisation. Then $(Y,\Delta_{Y}+Y_{k})$ is a $\mathbb{Q}$-factorial plt pair and hence $Y_{k}$ is normal by \autoref{plt-adj}. 
	By construction $f$ is $(K_{Y}+\Delta_{Y})$-trivial so \autoref{invAdj2} ensures the result.
\end{proof}

The result also holds in dimension $4$ when the residue field is perfect of char $p>5$, under the assumption that resolutions exist by \cite{hacon2020relative} together with \cite[Theorem 1.1]{hacon2017rationality}, \cite[Corollary 1.3]{arvidsson2020kawamata}.


\subsection{Rational Polytopes of Boundaries}

In this section we recall relevant information about rational polytopes and their application to different kinds of birational models.

A non-exhaustive list of important kinds of birational models is as follows.

\begin{definition}\label{Model-defs}
	Let $\phi\colon X \dashrightarrow Y$ be a birational contraction. Take a divisor $D$ and write $D'=\phi_{*}D$. 
	
	We say it is $D$-non-positive (resp. $D$-negative) if there is a common resolution $p\colon W \to X$, $q\colon W \to Y$ where 
	
	\[p^{*}D=q^{*}D'+E\]
	and $E \geq 0$ is $q$ exceptional (resp. $E \geq 0$ is $q$ exceptional and contains the strict transform of every $\phi$ exceptional divisor in its support). 
	
	If $(X,\Delta)/T$ is a psuedoeffective lc $R$-pair then $\phi$ is a weak log canonical (wlc) model if $\phi$ is a $K_{X}+\Delta$ non-positive birational contraction over $T$ with $K_{Y}+\Delta_{Y}$ nef, where $\Delta_{Y}=\phi_{*}\Delta$. As $\phi$ is non-positive $(Y,\Delta_{Y})$ is always lc and if $(X,\Delta)$ is klt then so is $(Y,\Delta_{Y})$. 
	
	If in fact $\phi$ is $K_{X}+\Delta$ negative, $Y$ is $\mathbb{Q}$-factorial, and $(Y,\Delta_{Y})$ is dlt then $\phi$ is a log terminal model. Again if $(X,\Delta)$ is dlt then the dlt condition on $(Y,\Delta_{Y})$ is automatic as $\phi$ is negative.
	
	If instead $\phi\colon X \dashrightarrow Y$ is a rational map then it is an ample model for $D$ if there is $H$ ample on $Y$ such that $p^{*}D\sim_{\mathbb{R}}q^{*}H+E$ where $E \geq 0$ is such that $E \leq B$ for any $p^{*}D \sim_{\mathbb{R}} B \geq 0$.
\end{definition}

Wlc models are not in general unique, but they are crepant. In particular we have the following.

\begin{lemma}\label{inv}
	Suppose that $(X,B)$ is a pseudo-effective log canonical pair, projective over $T$. 
	Let $\phi_{i} \colon (X, B) \dashrightarrow (Y_{i},B_{i})$ be wlc models for $(X,B)$ over $T$. 
	Then $K_{Y_{1}}+B_{1}$ is semi-ample over $T$ if and only if $K_{Y_{2}}+B_{2}$ is so.
\end{lemma}

\begin{proof}
	Let $f \colon Z \to X$ be a projective birational contraction of normal schemes together with proper birational contractions $g_i \colon Z \to Y_i$. 
	We can write $$K_Z+\Delta_Z = g_i^*(K_{Y_i}+B_i) + E_i,$$
	where $E_i$ are effective and $g_i$-exceptional divisors.
	Consider 
	$$g_1^*(K_{Y_1}+B_1)-g_2^*(K_{Y_2}+B_2)=E_2-E_1. $$
	In particular, $E_2-E_1$ is $g_2$-nef and therefore by the negativity lemma, \autoref{negatvity}, we conclude that $E_2 -E_1 \leq 0$. By symmetry, we conclude that $E_2=E_1$. Therefore $g_1^*(K_{Y_1}+B_1)=g_2^*(K_{Y_2}+B_2)$. In particular, $K_{Y_1}+B_1$ is semi-ample over $T$ iff $K_{Y_2}+B_2$ is so.
\end{proof}

Ample models, on the other hand, are always unique. If $X \dashrightarrow Y$ and $X \dashrightarrow Z$ are two ample models, then on some common resolution $W$ of both maps we have $f\colon W \to Y$, $g\colon W \to Z$ and $h\colon W \to X$. Now there are ample divisors $A_{Y}$, $A_{Z}$ with $f^{*}A_{Y}+E_{Y}\sim_{\mathbb{R}}h^{*}D \sim_{\mathbb{R}}g^{*}A_{Z}+E_{Z}$. But by definition $E_{Z}=E_{Y}$ and hence $f^{*}A_{Y}\sim_{\mathbb{R}}g^{*}A_{Z}$, so there is an isomorphism $i\colon Z \to Y$ with $i \circ f= g$ as required.


If $(X,\Delta)$ is a pair then we say $\phi\colon X \dashrightarrow Y$ is an ample model of $(X,\Delta)$ if it is an ample model for $K_{X}+\Delta$. We can often replace pairs with linearly equivalent versions.

\begin{lemma}\label{equiv}\cite[Lemma 3.6.8]{BCHM10}
	Let $\phi\colon X \to Y$ be a rational map. Suppose $(X,\Delta)$ and $(X,\Delta')$ are two pairs and $D,D'$ two $\mathbb{R}$-Cartier divisors on $X$. Take $t >0$ a positive real number.
	\begin{itemize}
		\item If $D \equiv tD'$ and $\phi_{*}D$, $\phi_{*}D'$ are both $\mathbb{R}$-Cartier then $\phi$ is $D$ negative (resp $D$ non-negative) if and only if it is $D'$ negative (resp. non-negative)
		\item If both pairs are lc and $K_{X}+\Delta \sim_{\mathbb{R}} t(K_{X}+\Delta')$ then $\phi$ is a wlc model for $(X,\Delta)$ if and only if it is a wlc model for $(X,\Delta')$.
		\item If both pairs are dlt and $K_{X}+\Delta \equiv t(K_{X}+\Delta')$ then $\phi$ is a log terminal model for $(X,\Delta)$ if and only if it is a log terminal model for $(X,\Delta')$.
		\item If $D\sim_{\mathbb{R}} tD$ then $\phi$ is an ample model for $D$ if and only if it is an ample model for $D'$.
	\end{itemize}
\end{lemma}

An import tool for studying different outputs of the MMP and associated models on a scheme are rational polytopes of divisors. We recall the definition of the various polytopes we will need.

\begin{definition}
	Let  $X$ be a normal, $\mathbb{Q}$-factorial, integral scheme and let $f \colon X \to T$ be a projective morphism such that the image of $X$ in $T$ is positive dimensional. 
	Fix a $\mathbb{Q}$-divisor $A\geq 0$. Let $V$ be a finite dimensional, rational affine subspace of $\text{WDiv}_{\mathbb{R}}(X)$ containing no components of $A$.
	
	We have the following subsets of $\text{WDiv}_\mathbb{R}(X)$.
	\[V_{A}= \{A+B \colon B \in V\};\]
	\[\mathcal{L}_{A}(V)=\{\Delta=A+B \in V_{A} \colon (X,\Delta) \textup{ is an lc pair}\};\]
	\[\mathcal{N}_{A}(V)=\{\Delta \in \mathcal{L}_{A}(V) \colon K_{X}+\Delta \textup{ is nef over } T\}.\]
	
	Given a birational contraction $\phi\colon X \dashrightarrow Y$ we also define
	%\[\mathcal{RW}_{A,\phi}(V)=\{\Delta \in \mathcal{RE}_{A}(V): \phi \text{ is a weak log canonical (wlc) model of } (X,\Delta)\}\]
	\[\mathcal{W}_{\phi}(C)=\{\Delta \in \mathcal{E}(C): \phi \text{ is a weak log canonical (wlc) model of } (X,\Delta)\}\]
	and given a rational map $\psi\colon X \dashrightarrow Z$
	%\[\mathcal{RA}_{A,\phi}(V)=\{\Delta \in \mathcal{RE}_{A}(V): \phi \text{ is the ample model of } (X,\Delta)\}\]
	\[\mathcal{A}_{\phi}(C)=\{\Delta \in \mathcal{E}(C): \phi \text{ is the ample model of } (X,\Delta)\}\]
\end{definition}

\begin{remark}
	
	The polytope $\mathcal{L}_{A}(V)$ does not depend on the morphism $X \to T$, however all the other polytopes introduced above do. We typically consider the projective morphism $X \to T$ as part of the data of $X$ and omit any reliance on it from the notation.
	
	\end{remark}

Recall that as long as there is a projective log resolution of $(X,A)$ together with (the support of) $V$ the set $\mathcal{L}_{A}(V)$ is a rational polytope by the work of Shokurov \cite{Sho92}, in particular this is true when $\dim X \leq 3$. Further if $(X,A+B)$ is klt and $(X,A+B')$ is lc then $(X,A+tB+(1-t)B')$ is klt for any $0 \leq t < 1$, so the set of klt pairs is open in $\mathcal{L}_{A}(V)$. In fact if $\mathcal{L}_{A}(V)$ contains a klt pair, the entire interior consists of klt boundaries and the same is true for any sub-polytope.

The cone theorem, even the slightly weaker form proved in mixed characteristic in \cite{bhatt2020}, implies that $\mathcal{N}_{A}(V)$ is a rational polytope. We record the result in dimension $3$.

\begin{lemma}\label{neftope} \cite[Proposition 9.31]{bhatt2020}
	Suppose that $R$ is an excellent threefold whose closed points have residue fields of characteristic $p=0$ or $p > 5$.
	Fix a $\mathbb{Q}$-divisor $A \geq 0$ such that $(X,A)/T$ is a $\mathbb{Q}$-factorial klt three-dimensional $R$-pair.
	Then $\mathcal{N}_{A}(V)$ is a rational polytope.
\end{lemma}

The further study of these objects will largely be deferred till \autoref{Finite}, where we will introduce a slightly more flexible notion of a pair in order to better work with such polytopes.

We include now, however, one important application. We can prove abundance for pairs with $\mathbb{R}$-boundaries given the appropriate results for $\mathbb{Q}$-boundaries.

\begin{proposition}\label{QtoR}
	Suppose that $R$ is an excellent threefold whose closed points have residue fields of characteristic $p=0$ or $p > 5$.
	Let $X \to T$ be a threefold $R$ pair where $\dim T \geq 1$. Suppose that for every $\mathbb{Q}$-divisor such that $(X,B)$ is klt and $K_{X}+B$ nef, then $K_{X}+B$ semiample.
	
	Then $K_X+\Delta$ is semiample for every $\mathbb{R}$-divisor $\Delta$ such that $(X,\Delta)$ is klt and $K_X+\Delta$ is nef.
\end{proposition}
\begin{proof}
	Let $\Delta= \sum_{1}^{n} t_{i}B_{i}$ and $V$ be the $\mathbb{R}$-linear span of $B_i$ in $\text{WDiv}_\mathbb{R}(X)$. By \autoref{neftope} we have that $\mathcal{N}_{0}(V)$ is a rational polytope. Hence there are rational boundaries $D_{i} \in \mathcal{N}_{0}(V)$ such that $\Delta=\sum \lambda_{i} D_{i}$ where $\sum \lambda_{i} =1$. Since $(X,\Delta)$ is klt, by choosing $D_{i}$ sufficiently close to $\Delta$ we may suppose that each $(X,D_{i})$ is a klt pair with $\mathbb{Q}$-boundary and $K_X+D_i$ $f$-nef. 
	By assumption $K_{X}+D_{i}$ is $f$-semiample and thus so is $K_{X}+\Delta=\sum \lambda_{i} (K_{X}+D_{i})$.
\end{proof}

%\bibliography{refs}
%\bibliographystyle{alpha}
%\end{document}



